/** m.tv.sohu.com, time 20150615 15:24:27, sohu inc */
svp.define("svp.foxPlayer",function(a,b,c){window.svp=window.svp||{};var d=a("base.console"),e=a("trace.click");svp.foxPlayer={maxId:1},svp.foxPlayer.ready=function(b){d.log("发送行为统计点:(play_display)"),e.pingback(null,"play_display"),$(document).ready(function(){var c=svp.$,d=!!document.all&&("Win32"==navigator.platform||"Win64"==navigator.platform||"Windows"==navigator.platform);d?c.isFunction(b)&&b(a("player.flash")):c.isFunction(b)&&b(a("player.foxPlayer"))})},c.exports=svp.foxPlayer}),svp.define("adv.android",function(a,b,c){"use strict";var d=svp.$,e=a("base.vars"),f=a("base.url"),g=a("base.util"),h=a("base.cookie"),i=a("adv.andorid.parseData"),j=a("player.loadCacheData"),k=a("trace.click"),l=a("base.sysMessage"),m=a("base.action"),n=a("data.appDownload"),o=a("base.console"),p=a("trace.video"),q=d.now(),r=function(a,b){var c={param:{player:null,pauseAdConClass:"svp_ad_pause_"+q,pauseAdCloseBtnClass:"svp_ad_pause_close_"+q,mediaTimerConClass:"svp_poster_ad_time_"+q,mediaTimerClass:"svp_poster_ad_timer_"+q,adDetailBtnClass:"svp_ad_detail_"+q,isPauseAd:!1,mediaAdPlatform:"none",addAdCallback:null,adClose:"0",debug:!1,debugCurUrl:"",timeout:2e3,timeoutFlag:!1,isGetFlag:!1,isValidFlag:!1,isFirstLoad:!0,ps:"",urls:{adrMedia:"http://m.aty.sohu.com/h",adrMediaDebug:"http://60.28.168.195/h",advIframe:"http://m.tv.sohu.com/upload/touch/public/showInIframe_new.html"}},model:{oldAdIndex:0,curAdIndex:-1,sendRepAdIndex:-1,cache:null,appid:"",mediaAd:{},effMediaData:[],mptIndex:[],videoData:null},view:{},ctrl:{}},r=c.param,s=c.model,t=c.view,u=c.ctrl;r.init=function(a,b){return d.isUndefined(a)?!1:(r.player=a,r=d.merge(r,b),null!==f.getQueryString("adClose")&&(r.adClose=f.getQueryString("adClose")),null!==f.getQueryString("ps")&&(r.ps=f.getQueryString("ps")),"0"!==b.adClose&&(r.adClose=b.adClose),r.debug=e.ENABLE_DEBUG,!0)},r.reset=function(){r.timeoutFlag=!1,r.isGetFlag=!1,r.isValidFlag=!1},s.init=function(a,b){s.cache=d.extend(!0,{},a.cache),s.videoData=a.videoData,s.appid=b.appid},s.reset=function(){s.oldAdIndex=0,s.curAdIndex=-1,s.cache=null,s.mediaAd={},s.effMediaData=[],s.mptIndex=[]},s.getQueryAdVideoURL=function(a,b){var c=a.cateCode||a.cate_code||"",e=["vid="+a.vid,"&uid="+h.get("SUV")||"","&plat=17","&pt="+g.getUserPt(),"&prod=h5","&pg=1&eye=0","&cateCode="+c.split(";")[0]||"","&advEFId="+a.advEFId].join("");return d.isUndefined(b)||(b+=(b.match(/\?/)?"&":"?")+e),b},s.getPlatId=function(){return e.IsAndroidPad?"h0":e.IsIphone?"h3":e.IsIpad?"h1":e.IsAndroid?"h6":"unknowm"},s.getAdParam=function(a){var b={};return b.pt="oad",b.plat=s.getPlatId(),b.sver="",b.sysver=e.OsVersion,b.c="tv",b.vc=s.getVc(a),b.pn=s.getPn(),b.al=a.plid||a.sid||a.aid||"",b.du=a.totalDuration||a.duration||a.total_duration||0,b.vid=a.vid||"",b.tvid=a.tvid||"",b.tuv=h.get("MUV")||h.get("SUV")||"",b.vu="",b.prot="vast",b.cat="1",b.ar=a.areaId||a.area_id||6,b.callback="getAdsCallback",b.json="std","0"!==r.adClose&&(b.adClose=r.adClose),b.appid=s.appid,b.pageUrl=window.location.href,b.type=a.site&&2===a.site||a.cid&&"9001"===a.cid?"my":"vrs",b.ag="",b.st="",b.partner=f.getQueryString("src")||f.getQueryString("SRC")||h.get("MTV_SRC")||"-2",b},s.getVc=function(a){var b=a.cateCode||a.cate_code||a.cid||"";return b&&b.indexOf(";")>-1&&(b=b.replace(/.*?;/,"")),b},s.getPn=function(){var a=s.getPlatId();return"h6"===a?"androidphone":"h3"===a?"iphone":"h16"===a?"androidpad":"h1"===a?"ipad":"unknowm"},s.getPauseAdInfo=function(a,b){b({imgUrl:"http://t12.baidu.com/it/u=3602855978,1840777505&fm=56"})},s.pauseAdInfoProcess=function(a){return a},s.sendInnerPingback=function(a,b){if("undefined"!=typeof a){var c={video_catecode:s.videoData.cateCode&&s.videoData.cateCode.split(";")[0]||"",video_plid:s.videoData.sid||s.videoData.plid||"",video_dur:s.cache.duration,partner:f.getQueryString("src")||f.getQueryString("SRC")||h.get("MTV_SRC")||"-2"};"video_ad_response"===a?(c.ad_status=1,c.ad_total_num=0,c.ad_empty_num=0,c.ad_eff_num=0,c.ad_total_dur=0):"video_ad_play"===a?(c.ad_is_empty=0,c.ad_total_num=s.mediaAd.realTotalCounts,c.ad_eff_num=s.mediaAd.effCounts):"video_ad_close"===a&&(c.ad_total_num=s.mediaAd.realTotalCounts,c.ad_eff_num=s.mediaAd.effCounts);for(var d in b)c[d]=b[d];o.log("发送内部行为统计数据 ("+a+"):",c),k.pingback(null,a,c)}},s.getAndroidAdInfo=function(b,c){var d;r.debug?(d=r.urls.adrMediaDebug+"?"+s.toString(b),o.log("android广告请求:"+d)):d=r.urls.adrMedia+"?"+s.toString(b),setTimeout(function(){r.isGetFlag||(o.log("android广告请求超时，直接播放视频"),s.sendInnerPingback("video_ad_response"),r.timeoutFlag=!0,a.adv.mediaAd=s.androidAdInfoProcess(),u.process.ended())},r.timeout),svp.debug.playerLoadAdDataStartTime=Date.now(),i.getData(d,function(a){a=s.androidAdInfoProcess(a),c(a)})},s.androidAdInfoProcess=function(a){var b={totalDuration:0,urls:{mp4:{nor:[]},downloadUrl:[]},durations:{nor:[]},adDataList:[],adVidList:[],realTotalCounts:0,emptyCounts:0,effCounts:0};if(!d.isUndefined(a)&&a instanceof Array){var c=1,e=1;d.each(a,function(a,f){if(!d.isUndefined(f.videoUrl)){var g={};g.duration=f.duration,g.clickUrl=f.clickUrl,g.vid=f.vid||"",g.cateCode=s.videoData.cateCode,g.advEFId="adv_id_"+a,g.counts=parseInt(f.cnt,10)||1,"error"!==f.videoUrl?(g.src=s.getQueryAdVideoURL(g,f.videoUrl),g.effAdPosition=e,e++):(g.src=f.videoUrl,g.effAdPosition=-1,b.emptyCounts+=g.counts),d.isUndefined(f.vid)||""===f.vid||b.adVidList.push(f.vid);for(var h=[],i=0;i<g.counts;i++)h.push(c+i);c+=g.counts,g.adPosition=h.join(","),b.adDataList.push(g),b.urls.mp4.nor.push(g.src),b.durations.nor.push(g.duration),b.realTotalCounts+=g.counts,"number"==typeof g.duration&&(b.totalDuration+=g.duration)}}),b.effCounts=b.realTotalCounts-b.emptyCounts}return b},s.toString=function(a){var b=[];for(var c in a)b.push(c+"="+encodeURIComponent(a[c]));return b.join("&")},s.getEffectiveMediaData=function(a){var b,c=d.extend(!0,{},a);for(b=c.adVidList.length-1;b>=0;b--)"error"===c.adVidList[b]&&c.adVidList.splice(b,1);for(b=c.adDataList.length-1;b>=0;b--){var e=c.adDataList[b];"error"===e.duration&&"error"===e.src&&c.adDataList.splice(b,1)}for(b=c.urls.mp4.nor.length-1;b>=0;b--)c.urls.mp4.nor[b].indexOf("error")>-1&&c.urls.mp4.nor.splice(b,1);for(b=c.durations.nor.length-1;b>=0;b--)(c.durations.nor[b]+"").indexOf("error")>-1&&c.durations.nor.splice(b,1);return c},t.pauseAd=function(a){var b=[];return b.push('<div class="ad_pause '+r.pauseAdConClass+'" style="display: none;">'),b.push('<img src="'+a.imgUrl+'">'),b.push('<em class="'+r.pauseAdCloseBtnClass+'"></em>'),b.push("</div>"),b.join("")},t.mediaTimer=function(){var a=[];return a.push('<span class="ad_time '+r.mediaTimerConClass+'" style="display: none;">'),a.push('<span class="ad_time_timer '+r.mediaTimerClass+'"></span>'),a.push('<span class="ad_remove" position="appdownload_adRemove">免费去广告</span>'),a.push("</span>"),a.join("")},t.mediaAdvDetail=function(){var a=[];return a.push('<div class="gg_area '+r.adDetailBtnClass+'">'),a.push('<div class="ad_detail">'),a.push("详情"),a.push("</div></div>"),a.join("")},u.init=function(a,b){r.init(a,b)&&s.init(a,b)},u.getPauseAdView=function(a){if(r.isPauseAd){var b={};s.getPauseAdInfo(b,function(b){a(t.pauseAd(b))})}else a("")},u.getMediaAdView=function(a){if(e.IsAndroid){var b="";b+=t.mediaTimer(),"1"!==r.ps&&(b+=t.mediaAdvDetail()),a(b)}else a("")},u.showParamAd=function(){r.isPauseAd&&d("."+r.pauseAdConClass).show()},u.hideParamAd=function(){r.isPauseAd&&d("."+r.pauseAdConClass).hide()},u.getAndroidAdInfo=function(a){var b=s.getAdParam(s.videoData);s.sendInnerPingback("video_ad_request"),s.getAndroidAdInfo(b,function(b){if(o.log("广告数据:",b),!r.timeoutFlag){var c={ad_status:0,ad_total_num:b.realTotalCounts,ad_empty_num:b.emptyCounts,ad_eff_num:b.effCounts,ad_total_dur:b.totalDuration};s.sendInnerPingback("video_ad_response",c),r.isGetFlag=!0,0!==b.totalDuration&&(r.isValidFlag=!0),a(b)}})},u.showMediaTimer=function(){d("."+r.mediaTimerConClass).css("display","block")},u.hideMediaView=function(){d("."+r.mediaTimerConClass).hide(),d("."+r.adDetailBtnClass).hide(),d(".ad_remove").hide()},u.updateMediaTimer=function(a){d("."+r.mediaTimerClass).html(a)},u.addAdView=function(a){0===d("."+r.mediaTimerConClass).length?(r.isPauseAd&&u.getPauseAdView(function(b){a.$main.append(b)}),r.mediaAdPlatform.indexOf("android")>-1&&u.getMediaAdView(function(b){a.$main.append(b)})):(d(".ad_remove").show(),d("."+r.adDetailBtnClass).show())},u.addAdvertise=function(a){var b=r.player;r.addAdCallback=a,u.getAndroidAdInfo(function(a){if(b.adv.mediaAd=a,s.mediaAd=a,"0"===r.adClose){if(a.adDataList.length>0&&o.log("android广告获取成功",a),b.duration=a.totalDuration,r.isFirstLoad&&(u.eventInit(),r.isFirstLoad=!1),0===a.adDataList.length)return o.log("没有获取到android广告贴片内容"),void u.process.ended();if(s.effMediaData=s.getEffectiveMediaData(s.mediaAd),s.effMediaData.adDataList.length>0){var c=b.config;c.isMediaAdContent=!0,c.modeType="nor",s.effMediaData.srcType="mp4",b.cache=new j(c,s.effMediaData),b.setSrc(b.cache.curPlayUrl),u.addAdView(b),u.updateMediaTimer(b.cache.duration),u.showMediaTimer(),b._firstLoadFlag=!0,b.play()}else s.curAdIndex=s.mediaAd.adDataList.length-1,d.each(s.mediaAd.adDataList,function(a,b){o.log("发送android空广告上报 cIndex:"+a),i.trackempty(a);var c={ad_inc_num:b.counts,ad_pos:b.adPosition,ad_eff_pos:b.effAdPosition,ad_dur:b.duration,ad_vid:b.vid};s.sendInnerPingback("video_ad_play",c)}),u.process.ended()}else o.log("android广告已经获取成功，但是广告被屏蔽"),s.sendInnerPingback("video_ad_close"),u.process.ended()})},u.emptyAdCheckAndReport=function(a){var b=a.cache.curPlayUrl;d.each(s.mediaAd.adDataList,function(a,c){if(a<=s.curAdIndex&&"error"===c.duration&&"error"===c.src&&!c.reportFlag){o.log("发送android空广告上报 cIndex:"+a),s.mptIndex.push(a),i.trackempty(a);var d={ad_inc_num:c.counts,ad_pos:c.adPosition,ad_eff_pos:c.effAdPosition,ad_dur:c.duration,ad_vid:c.vid};s.sendInnerPingback("video_ad_play",d),c.reportFlag=!0}return b===c.src&&a>s.oldAdIndex?(s.curAdIndex=a,!1):void 0})},u.getCurAdIndex=function(){var b=0,c=a.getSrc()||"";return d.each(s.mediaAd.adDataList,function(a,d){return"error"!==d.src&&c.indexOf(d.src.split("?")[1])>-1?(b=a,!1):void 0}),b},u.updateAdv=function(){r.reset(),s.reset(),r.player.adv.isMediaPlayed=!1,s.cache=d.extend(!0,{},r.player.cache),s.videoData=r.player.videoData,u.addAdvertise(r.addAdCallback)},u.eventInit=function(){var a=u.process,b=r.player;b.$midPlay.on(e.END_EVENT,function(){a.play(this)}),b.$main.on(e.END_EVENT,".ad_remove",function(){return a.adRemove(this),!1}),b.$main.on(e.END_EVENT,"."+r.adDetailBtnClass,function(){a.adDetail()}),b._addEvent("timeupdate",a.timeupdate),b._addEvent("pause",a.pause),b.on("advended",function(){a.ended("force"),e.IsAndroid&&e.IsBaiduBoxApp&&!b._sendRealVVFlag&&(o.log("统计: reallvv"),p.realVV(b._startPlayTime),b._sendRealVVFlag=!0)}),r.isPauseAd&&b._addEvent("playing",a.playing)},u.process={},u.process.adRemove=function(a){k.pingback(d(a)),r.player.pause(),n.getChannelInfo(null,function(a){if("1"===a.startapp){var b=m.parserAttributes();b.action="1.1",b.type="click",m.sendAction(b)}}),l.downloadPopTips({title:"零广告看视频，请先安装搜狐视频APP"})},u.process.adDetail=function(){if(s.mediaAd.adDataList){var a=s.curAdIndex,b=r.urls.advIframe+"?url="+encodeURIComponent(s.mediaAd.adDataList[a].clickUrl);o.log("android click广告上报: clickIndex: "+a),i.trackClick(a),k.pingback(null,"ad_detail_click"),r.player.pause(),setTimeout(function(){window.open(b)},50)}},u.process.timeupdate=function(){var a=r.player;if(!a.cache.isMediaAdContent)return void u.hideMediaView();if(r.debug&&r.debugCurUrl!==a.cache.curPlayUrl&&(o.log("当前播放视频地址:"+JSON.stringify(a.cache.curPlayUrl)),r.debugCurUrl=a.cache.curPlayUrl),!a.adv.isMediaPlayed){var b=a.adv,c=a.videoTag.currentTime;if(0===c)return;var f=a.currentTime;if(f>0&&Math.abs(f-a._lastCurTime)>2&&(a._startPlayTime=d.now()),b.isMediaPlayed||e.IsBaiduBrowser||e.IsBaiduBoxApp)a._lastCurTime=f;else{if(f-a._lastCurTime>5)return void a.seekTo(a._lastCurTime);a._lastCurTime=f}if(-1===s.curAdIndex&&(s.curAdIndex=u.getCurAdIndex()),a.hidePoster(),a.$mid.oriHide(),a._hideMainCtrl(),u.emptyAdCheckAndReport(a),s.oldAdIndex!==s.curAdIndex)return-1===d(s.mptIndex).indexOf(s.oldAdIndex)&&(o.log("android end广告上报: endIndex: "+s.oldAdIndex),i.trackAdComplete(s.oldAdIndex)),void(s.oldAdIndex=s.curAdIndex);if(i.trackAd(c,s.curAdIndex),s.sendRepAdIndex!==s.curAdIndex){var g=s.mediaAd.adDataList[s.curAdIndex],h={ad_is_empty:1,ad_inc_num:g.counts,ad_pos:g.adPosition,ad_eff_pos:g.effAdPosition,ad_dur:g.duration,ad_vid:g.vid};s.sendInnerPingback("video_ad_play",h),s.sendRepAdIndex=s.curAdIndex}u.updateMediaTimer(a.cache.duration-parseInt(a.currentTime,10))}},u.process.ended=function(a){var b=r.player;if("undefined"!=typeof a&&"force"===a||!d.isUndefined(b.adv)&&!b.adv.isMediaPlayed&&b.duration-b.currentTime<1||"0"!==r.adClose){b.$video.attr("data-adover","true"),"0"===r.adClose&&r.isGetFlag&&r.isValidFlag&&(o.log("android end广告上报: endIndex: "+s.curAdIndex),s.curAdIndex=-1===s.curAdIndex?0:s.curAdIndex,i.trackAdComplete(s.curAdIndex)),b.$maskLayer.oriHide(),u.hideMediaView(),b.cache=s.cache,b.setSrc(b.cache.curPlayUrl),b.adv.isMediaPlayed=!0,b.cache.isMediaAdContent=!1,b.currentTime=0,console.log("设置为0");var c=b.adv.mediaAd.adDataList;try{if(s.curAdIndex<c.length-1)for(var f=s.curAdIndex+1;f<c.length;f++){var g="发送android"+("0"!==r.adClose?"":"空")+"广告上报 cIndex:";o.log(g+f),i.trackempty(f);var h={ad_inc_num:c[f].counts,ad_pos:c[f].adPosition,ad_eff_pos:c[f].effAdPosition,ad_dur:c[f].duration,ad_vid:c[f].vid};s.sendInnerPingback("video_ad_play",h)}}catch(j){}e.IsIphone&&e.IsWeixinBrowser||b._showMainCtrl(),e.IsQQBrowser||e.IsBaiduBrowser?setTimeout(function(){b.play()},50):b.play(),d.isFunction(r.addAdCallback)&&r.addAdCallback()}},u.process.pause=function(){d.isUndefined(a.adv)||a.adv.isMediaPlayed||(a._showMidPlayBtn(),r.isPauseAd&&u.showParamAd())},u.process.play=function(a){a.adv&&!a.adv.isMediaPlayed&&(a.$mid.oriHide(),a.play())},u.process.playing=function(){u.hideParamAd()},u.init(a,b),this.isMediaPlayed=!1,this.addAdvertise=u.addAdvertise,this.updateAdv=u.updateAdv,this.gotoEnd=u.process.ended,this.hideMediaView=u.hideMediaView};c.exports=r}),svp.define("adv.ios",function(a,b,c){"use strict";var d=svp.$,e=a("base.vars"),f=a("base.url"),g=a("base.cookie"),h=a("base.console"),i=function(a,b){var c={param:{player:null,adClose:"0",debug:!1,debugCurUrl:"",timeout:2e3,timeoutFlag:!1,getAdInfoFlag:!1,addAdCallback:null,dragCheckFlag:!0,urls:{iosMedia:"http://m.aty.sohu.com/h",iosMediaDebug:"http://60.28.168.195/h"}},model:{cache:null,totDuration:0,appid:"",curIndex:0,adDurList:[],mediaAd:{},videoData:null},view:{},ctrl:{}},i=c.param,j=c.model,k=(c.view,c.ctrl);i.init=function(a,b){return d.isUndefined(a)?!1:(i.player=a,i=d.merge(i,b),null!==f.getQueryString("adClose")&&(i.adClose=f.getQueryString("adClose")),"0"!==b.adClose&&(i.adClose=b.adClose),i.debug=e.ENABLE_DEBUG,!0)},i.reset=function(){i.timeoutFlag=!1,i.getAdInfoFlag=!1},j.init=function(a,b){j.cache=d.extend(!0,{},a.cache),j.videoData=a.videoData,j.appid=b.appid},j.reset=function(){j.cache=null,j.videoData=null,j.totDuration=0,j.curIndex=0,j.adDurList=[],j.mediaAd={}},j.getAdParam=function(a){var b={};return b.pt="oad",b.plat=j.getPlatId(),b.sysver=e.OsVersion,b.c="tv",b.cat="1",b.vc=j.getVc(a),b.pn=j.getPn(),b.al=a.plid||a.sid||a.aid||"",b.ag="",b.st="",b.ar=a.areaId||a.area_id||6,b.vu="",b.tuv=g.get("MUV")||g.get("SUV")||"",b.appid=j.appid,b.type=a.site&&2===a.site||a.cid&&"9001"===a.cid?"my":"vrs","0"!==i.adClose&&(b.adClose=i.adClose),b.vid=a.vid||"",b.tvid=a.tvid||a.tv_id||"",b.pageUrl=window.location.href,b.du=a.totalDuration||a.duration||a.total_duration||0,b.partner=f.getQueryString("src")||f.getQueryString("SRC")||g.get("MTV_SRC")||"-2",b},j.getPlatId=function(){return e.IsAndroidPad?"h0":e.IsIphone?"h3":e.IsIpad?"h1":e.IsAndroid?"h6":"unknowm"},j.getVc=function(a){var b=a.cateCode||a.cate_code||a.cid||"";return b&&b.indexOf(";")>-1&&(b=b.replace(/.*?;/,"")),b},j.getPn=function(){var a=j.getPlatId();return"h6"===a?"androidphone":"h3"===a?"iphone":"h16"===a?"androidpad":"h1"===a?"ipad":"unknowm"},j.repOrAddParams=function(a){try{if(""!==a&&a.indexOf("mmg.aty.sohu.com")>=1){var b=a.match(/partner=([a-zA-Z0-9\-_\|]*)/i),c=f.getQueryString("src")||f.getQueryString("SRC")||g.get("MTV_SRC")||"-2";(null===b||b.length>=2&&""===b[1])&&(a=a+"&partner="+c)}}catch(d){h.log(d)}var e=a.match(/urldomain=([a-zA-Z0-9\-_\|]*)/i);return(null===e||e.length>=2&&""===e[1])&&(a=a+"&urldomain="+window.location.host),a},j.sendPingback=function(a){if(""!==a){var b=a.split("|");d.each(b,function(a,b){var c=document.createElement("script");b=j.repOrAddParams(b),h.log("上报统计URL",b),c.src=b,d("body").append(c)})}},j.toString=function(a){var b=[];for(var c in a)b.push(c+"="+encodeURIComponent(a[c]));return b.join("&")},j.getIosAdInfo=function(a,b){var c;i.debug?(c=i.urls.iosMediaDebug,h.log("ios广告请求:"+c+"?"+j.toString(a))):c=i.urls.iosMedia,d.ajax({url:c,data:a,dataType:"jsonp",success:b})},j.initAdDurList=function(a){var b=[];return d.each(a.adDataList,function(a,c){b.push(c.duration)}),b},j.isoAdInfoProcess=function(a){var b={adVidList:[],adDataList:[],totDuration:0,realTotalCounts:0,emptyCounts:0,effCounts:0};if(!d.isUndefined(a)&&1===a.status){var c=a.data.oad;if(c instanceof Array){var e=1,g=1;d.each(c,function(a,c){var h={};d.isUndefined(c.vid)||""===c.vid?h.effAdPosition=-1:(b.adVidList.push(c.vid),h.effAdPosition=g,g++),"number"==typeof c.duration&&(b.totDuration+=c.duration),h.duration=c.duration||0,h.clickUrl=c.clickurl?c.clickurl:"",h.pingback=c.pingback||"",h.pingbacks=c.pingbacks||[],h.vid=c.vid||"",h.finishPingback=c.finishedstatistics||"";var i=h.pingback?f.getQueryData(h.pingback):"",j=i.p?i.p.split(","):[];h.counts=j.length,0===h.duration&&(b.emptyCounts+=h.counts),b.realTotalCounts+=h.counts;for(var k=[],l=0;l<h.counts;l++)k.push(e+l);e+=h.counts,h.adPosition=k.join(","),b.adDataList.push(h)}),b.effCounts=b.realTotalCounts-b.emptyCounts}}return b},j.sendInnerPingback=function(a,b){if("undefined"!=typeof a){var c={video_catecode:j.videoData.cateCode&&j.videoData.cateCode.split(";")[0]||"",video_plid:j.videoData.sid||j.videoData.plid||"",video_dur:j.cache.totalDuration,partner:f.getQueryString("src")||f.getQueryString("SRC")||g.get("MTV_SRC")||"-2"};"video_ad_response"===a?(c.ad_status=1,c.ad_total_num=0,c.ad_empty_num=0,c.ad_eff_num=0,c.ad_total_dur=0):"video_ad_play"===a?(c.ad_is_empty=0,c.ad_total_num=j.mediaAd.realTotalCounts,c.ad_eff_num=j.mediaAd.effCounts):"video_ad_close"===a&&(c.ad_total_num=j.mediaAd.realTotalCounts,c.ad_eff_num=j.mediaAd.effCounts);for(var d in b)c[d]=b[d];h.log("发送内部行为统计数据 ("+a+"):",c)}},k.init=function(a,b){i.init(a,b)&&(j.init(a,b),k.eventInit())},k.addAdvertise=function(b){this.isMediaPlayed=!1,i.addAdCallback=b;var c=i.player.cache;setTimeout(function(){i.getAdInfoFlag||(i.timeoutFlag=!0,h.log("ios广告请求超时，直接播放视频"),j.sendInnerPingback("video_ad_response"),c.curPlayUrl=c.srcList[c.modeType][0].url,a.initVideoTag(),a.adv.isMediaPlayed=!0,d.isFunction(b)&&b())},i.timeout),j.sendInnerPingback("video_ad_request"),svp.debug.playerLoadAdDataStartTime=Date.now(),k.getIosAdInfo(function(e){if(h.log("获取ios广告完成, 耗时--->"+(Date.now()-svp.debug.playerLoadAdDataStartTime)/1e3),!i.timeoutFlag){j.mediaAd=e;var f={ad_status:0,ad_total_num:e.realTotalCounts,ad_empty_num:e.emptyCounts,ad_eff_num:e.effCounts,ad_total_dur:e.totDuration};j.sendInnerPingback("video_ad_response",f),j.totDuration=e.totDuration;var g=i.player.adv;if(g.mediaAd=e,j.adDurList=j.initAdDurList(g.mediaAd),"0"===i.adClose){h.log("ios广告获取成功",e);for(var k in c.srcList)d.each(c.srcList[k],function(a,b){e.adVidList.length>0&&(b.url+=(b.url.indexOf("?")>-1?"&":"?")+"ads="+e.adVidList.join(","))})}else a.adv.isMediaPlayed=!0,h.log("ios广告已经获取成功，但是广告被屏蔽",e),j.sendInnerPingback("video_ad_close"),g=i.player.adv,d.each(g.mediaAd.adDataList,function(a,b){j.sendPingback(b.pingback);var c={ad_inc_num:b.counts,ad_pos:b.adPosition,ad_eff_pos:b.effAdPosition,ad_dur:b.duration,ad_vid:b.vid};if(0!==b.duration?(h.log("ios广告上报 start:"+b.pingback),c.ad_is_empty=1):h.log("ios空广告上报 start:"+b.pingback),j.sendInnerPingback("video_ad_play",c),b.pingback="",0!==b.pingbacks.length){var d=b.pingbacks[0];0===d.v&&(j.sendPingback(d.v),h.log(0!==b.duration?"ios广告上报 v:"+d.v+", curIndex: 0":"ios空广告上报 v: "+d.v+", curIndex: 0"))}});c.curPlayUrl=c.srcList[c.modeType][0].url,a.setSrc(c.curPlayUrl),a._play(),d.isFunction(b)&&b()}})},k.updateAdv=function(){i.reset(),j.reset(),i.player.adv.mediaAd=null,i.player.adv.isMediaPlayed=!1,j.cache=d.extend(!0,{},i.player.cache),j.videoData=i.player.videoData,k.addAdvertise(i.addAdCallback)},k.getIosAdInfo=function(a){if(e.IsIphone||e.IsIpad){var b=j.getAdParam(j.videoData);j.getIosAdInfo(b,function(b){i.getAdInfoFlag=!0;var c=j.isoAdInfoProcess(b);a(c)})}else{var c=j.isoAdInfoProcess();a(c)}},k.eventInit=function(){var a=k.process;i.player._addEvent("timeupdate",a.timeupdate)},k.process={},k.process.timeupdate=function(){var a=this,b=a.currentTime;if(i.debug&&i.debugCurUrl!==a.cache.curPlayUrl&&(h.log("当前播放视频地址:"+JSON.stringify(a.cache.curPlayUrl)),i.debugCurUrl=a.cache.curPlayUrl),0!==b&&i.dragCheckFlag){var c=a.adv,e=c.mediaAd.adDataList,f=c.mediaAd.adVidList;if(!a.adv.isMediaPlayed&&null!==i.player.adv.mediaAd)if(a._showPlayBtn(),"0"!==i.adClose)a.adv.isMediaPlayed=!0,d.each(e,function(a,b){b.pingback+=b.pingback.indexOf("?")>-1?"&":"?",b.pingback+="adClose="+i.adClose,j.sendPingback(b.pingback),h.log("ios广告上报 start:"+b.pingback);var c={ad_is_empty:1,ad_inc_num:b.counts,ad_pos:b.adPosition,ad_eff_pos:b.effAdPosition,ad_dur:b.duration,ad_vid:b.vid};j.sendInnerPingback("video_ad_play",c),b.pingback=""});else{if(b>0&&Math.abs(b-this._lastCurTime)>2&&(this._startPlayTime=d.now()),i.dragCheckFlag&&b-a._lastCurTime>2)return i.dragCheckFlag=!1,a.seekTo(a._lastCurTime),void setTimeout(function(){i.dragCheckFlag=!0},1e3);var g=0,k=0;d.each(j.adDurList,function(c,d){return 0===g&&0===c&&(g=d,k=d),b=parseInt(b,10),b>=g&&0!==c&&(g+=d,k=d,g>=b&&(j.curIndex=c),c===j.adDurList.length-1&&b>=g)?(j.curIndex=c,a.$video.attr("data-adover","true"),!1):void 0}),f.length!==e.length&&d.each(e,function(a,b){if(!(a<=j.curIndex))return!1;if(0===b.duration&&""!==b.pingback){if(j.sendPingback(b.pingback),h.log("ios空广告上报 start:"+b.pingback),""!==b.pingback){var c={ad_inc_num:b.counts,ad_pos:b.adPosition,ad_eff_pos:b.effAdPosition,ad_dur:b.duration,ad_vid:b.vid};j.sendInnerPingback("video_ad_play",c)}b.pingback="",d.each(b.pingbacks,function(a,c){0===c.t&&(j.sendPingback(c.v),l.pingbacks.length=0,h.log("ios空广告上报 v: "+b.v+", curIndex: "+a))})}}),b>j.totDuration&&j.curIndex===e.length-1&&(a.adv.isMediaPlayed=!0,a.trigger("advended")),a._lastCurTime=b;var l=c.mediaAd.adDataList[j.curIndex],m=parseInt(b,10);if(m-=g-k,0===m&&""!==l.pingback){if(j.sendPingback(l.pingback),h.log("ios广告上报 start:"+l.pingback),""!==l.pingback){h.log("发送内部行为统计数据: video_ad_play");var n={ad_is_empty:1,ad_inc_num:l.counts,ad_pos:l.adPosition,ad_eff_pos:l.effAdPosition,ad_dur:l.duration,ad_vid:l.vid};j.sendInnerPingback("video_ad_play",n)}l.pingback=""}d.each(l.pingbacks,function(a,b){m===b.t&&(j.sendPingback(b.v),l.pingbacks.splice(a,1),h.log("ios广告上报 v: "+b.v+", curIndex: "+a))}),m>=l.duration-1&&""!==l.finishPingback&&(j.sendPingback(l.finishPingback),l.finishPingback="",h.log("ios end广告上报: endIndex: "+j.curIndex))}}},k.init(a,b),this.isMediaPlayed=!1,this.addAdvertise=k.addAdvertise,this.updateAdv=k.updateAdv,this.gotoEnd=function(){i.player.seekTo(i.player.cache.duration)}};c.exports=i}),svp.define("adv.andorid.parseData",function(a,b,c){var d=a("base.url"),e=a("base.vars"),f=a("base.console");window.getAdsCallback=function(a){function b(a){var b,c,e,f,g,h,i;for(h=a.length,g=0,i="";h>g;){do b=d[255&a.charCodeAt(g++)];while(h>g&&-1==b);if(-1==b)break;do c=d[255&a.charCodeAt(g++)];while(h>g&&-1==c);if(-1==c)break;i+=String.fromCharCode(b<<2|(48&c)>>4);do{if(e=255&a.charCodeAt(g++),61==e)return i;e=d[e]}while(h>g&&-1==e);if(-1==e)break;i+=String.fromCharCode((15&c)<<4|(60&e)>>2);do{if(f=255&a.charCodeAt(g++),61==f)return i;f=d[f]}while(h>g&&-1==f);if(-1==f)break;i+=String.fromCharCode((3&e)<<6|f)}return i}function c(a){var b,c,d,e,f,g;for(b="",d=a.length,c=0;d>c;)switch(e=a.charCodeAt(c++),e>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:b+=a.charAt(c-1);break;case 12:case 13:f=a.charCodeAt(c++),b+=String.fromCharCode((31&e)<<6|63&f);break;case 14:f=a.charCodeAt(c++),g=a.charCodeAt(c++),b+=String.fromCharCode((15&e)<<12|(63&f)<<6|(63&g)<<0)}return b}f.log("获取Android广告完成, 耗时--->"+(Date.now()-svp.debug.playerLoadAdDataStartTime)/1e3);var d=new Array(-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1);xmlData=c(b(a)),vast.parseData(xmlData),f.log("Android广告模块解析完成, 耗时--->"+(Date.now()-svp.debug.playerLoadAdDataStartTime)/1e3)},function(){function a(a){a&&a.indexOf("mmg.aty.sohu.com")>-1&&(a=c.repOrAddParams(a)),f.log("adEngine trackImg URL",a);var b=new Image;b.src=a,h.push(b)}var b,c=window.vast={},g=new Array,h=[];c.parseData=function(a){function d(a){var b=a.split(":"),c=parseInt(b[0]),d=parseInt(b[1]),e=parseInt(b[2]),f=3600*c+60*d+e;return f}window.DOMParser?(parser=new DOMParser,xmlDoc=parser.parseFromString(a,"text/xml")):(xmlDoc=new ActiveXObject("Microsoft.XMLDOM"),xmlDoc.async="true",xmlDoc.loadXML(a)),f.log(a);for(var h=xmlDoc.getElementsByTagName("Ad"),i=0;i<h.length;i++){for(var j={},k={},l=h[i].getElementsByTagName("InLine"),m=0;m<l.length;m++){var n=l[m].tagName,o=l[m].getElementsByTagName("AdSystem")[0].tagName,p=l[m].getElementsByTagName("AdSystem")[0].childNodes[0].nodeValue;k[o]=p;var q=l[m].getElementsByTagName("AdTitle")[0].tagName,r=l[m].getElementsByTagName("AdTitle")[0].childNodes[0].nodeValue;k[q]=r;var s=l[m].getElementsByTagName("Description")[0].tagName,t=l[m].getElementsByTagName("Description")[0].childNodes[0].nodeValue;k[s]=t;for(var u=l[m].getElementsByTagName("Impression"),v=new Array,w=0;w<u.length;w++){var x={},y={},z=l[m].getElementsByTagName("Impression")[w].tagName,A=l[m].getElementsByTagName("Impression")[w].childNodes[0].nodeValue,A=A.replace(/\s/g,"");x[z]=A;var B=l[m].getElementsByTagName("Impression")[w].getAttribute("id");y[B]=x,v.push(y)}k.Imp=v,k.isImp=!1;for(var C=l[m].getElementsByTagName("Creatives")[0],D=C.getElementsByTagName("Creative"),E=0;E<D.length;E++){var F=D[E].getElementsByTagName("Linear")[0],G=F.getElementsByTagName("Duration")[0].tagName,H=F.getElementsByTagName("Duration")[0].childNodes[0].nodeValue;k[G]=d(H);for(var I=F.getElementsByTagName("MediaFiles")[0],J=I.getElementsByTagName("MediaFile"),K=new Array,L=0;L<J.length;L++){var M={};if(J[L].hasChildNodes())var N=J[L].tagName,O=J[L].childNodes[0].nodeValue,O=O.replace(/\s/g,"");else var O=null;M[N]=O;var P=J[L].getAttribute("width");M.width=P;var Q=J[L].getAttribute("height");M.height=Q;var R=J[L].getAttribute("type");M.type=R;var S=J[L].getAttribute("vid");M.vid=S,K.push(M)}k.MediaFile=K;for(var T=F.getElementsByTagName("VideoClicks")[0],U=T.getElementsByTagName("ClickThrough"),V=0;V<U.length;V++){var W=U[V].tagName,X=U[V].childNodes[0].nodeValue,X=X.replace(/\s/g,"");k[W]=X}var Y=T.getElementsByTagName("ClickTracking"),Z=new Array;if(T.hasChildNodes()){for(var $=0;$<Y.length;$++){var _={},aa=Y[$].tagName,ba=Y[$].childNodes[0].nodeValue,ba=ba.replace(/\s/g,"");_[aa]=ba;var ca=Y[$].getAttribute("id");_.id=ca,Z.push(_)}k.ClickTracking=Z}var da=F.getElementsByTagName("TrackingEvents")[0];if(void 0!=da){for(var ea=da.getElementsByTagName("Tracking"),fa=new Array,ga=0;ga<ea.length;ga++){var ha={},ia=ea[ga].tagName,ja=ea[ga].childNodes[0].nodeValue,ja=ja.replace(/\s/g,"");ha[ia]=ja,adProTrkEvent=ea[ga].getAttribute("event"),adProTrkId=ea[ga].getAttribute("id"),adProTrkOffset=ea[ga].getAttribute("offset"),ha.event=adProTrkEvent,ha.id=adProTrkId,ha.isTrack=!1,ha.offset=null!=adProTrkOffset?d(adProTrkOffset):adProTrkOffset,fa.push(ha)}k.Tracking=fa}}for(var ka=l[m].getElementsByTagName("Extensions")[0],la=ka.getElementsByTagName("Extension"),ma=0;ma<la.length;ma++)for(var na=la[ma].getElementsByTagName("AdParams")[0],oa=(na.getAttribute("adStyle"),na.getAttribute("sequence"),na.getElementsByTagName("CallbackFun")),pa=0;pa<oa.length;pa++);j[n]=k}g.push(j)}for(var qa=[],ra={},i=0;i<g.length;i++){var sa=g[i].InLine.MediaFile[0].MediaFile,ta=g[i].InLine.ClickThrough,ua=g[i].InLine.Duration,S=g[i].InLine.MediaFile[0].vid;null!=sa?(ra.videoUrl=sa,ra.clickUrl=ta,ra.duration=ua,ra.vid=S,ra=c.cbDataProcess(ra,g[i].InLine),qa.push(ra),ra={}):(ra.videoUrl="error",ra.clickUrl="error",ra.duration="error",ra.vid="error",ra=c.cbDataProcess(ra,g[i].InLine),qa.push(ra),ra={})}e.ENABLE_DEBUG&&f.log("android 广告数据:"+JSON.stringify(g)),b(qa)},c.getData=function(a,c){"undefined"!=typeof g&&g instanceof Array&&(g=[]),b=c;var d=document.createElement("script");d.setAttribute("type","text/javascript"),d.src=a,document.body.appendChild(d)},c.trackAd=function(b,d){var e=g[d],f=Math.floor(b);if(c.trackempty(d),void 0!=e.InLine.Tracking)for(var h=e.InLine.Tracking.length,i=0;h>i;i++){var j=e.InLine.Tracking[i];j.isTrack||f!=j.offset||(a(j.Tracking),j.isTrack=!0)}},c.trackImp=function(){var b=g.length,c=0;for(c=0;b>c;c++){var d=g[c];d.InLine.isImp=!0;for(var e=d.InLine.Imp.length,f=0;e>f;f++){var h,i=d.InLine.Imp[f];for(var j in i)h=i[j].Impression;a(h)}}},c.trackempty=function(b){var c=g[b];if(!c.InLine.isImp){f.log("fff:"+b);for(var d=c.InLine.Imp.length,e=0;d>e;e++){var h,i=c.InLine.Imp[e];for(var j in i)h=i[j].Impression;c.InLine.isImp=!0,a(h)}}},c.trackAdComplete=function(b){var c=g[b];if(void 0!=c.InLine.Tracking)for(var d=0;d<c.InLine.Tracking.length;d++)"complete"==c.InLine.Tracking[d].event&&a(c.InLine.Tracking[d].Tracking)},c.trackClick=function(b){var c=g[b];if(void 0!=c.InLine.ClickTracking)for(var d=c.InLine.ClickTracking.length,e=0;d>e;e++){var f=c.InLine.ClickTracking[e],h=f.ClickTracking;a(h)}},c.getQueryString=function(a){var b=new RegExp("(^|&?)"+a+"=([^&]*)(&|$)","i"),c=window.location.search.substr(1).match(b);return null!==c?unescape(c[2]):null},c.getCookie=function(a){for(var b,c=document.cookie.split(";"),d=0;d<c.length;d++)if(b=c[d].split("="),b[0].trim()==a)return unescape(b[1]);return""},c.repOrAddParams=function(a){try{if(""!==a&&a.indexOf("mmg.aty.sohu.com")>-1){var b=a.match(/partner=([a-zA-Z0-9\-_\|]*)/i),d=c.getQueryString("src")||c.getQueryString("SRC")||c.getCookie("MTV_SRC")||"-2";(null===b||b.length>=2&&""===b[1])&&(a=a+"&partner="+d)}}catch(e){f.log(e)}var g=a.match(/urldomain=([a-zA-Z0-9\-_\|]*)/i);return(null===g||g.length>=2&&""===g[1])&&(a=a+"&urldomain="+window.location.host),a},c.cbDataProcess=function(a,b){var c=b.Imp[0].monitorServer.Impression,e=d.getQueryData(c),f=e.p?e.p.split(","):[];return a.cnt=f.length,a}}(),c.exports=vast}),svp.define("player.controls",function(a){"use strict";a("player.ctrlProgress"),a("player.ctrlButton"),a("player.ctrlHd"),a("player.ctrlFullscreen");var b=a("base.vars"),c=a("player.mediaPlayer");c.prototype._hideMainCtrl=function(){var a=this;clearInterval(this._mainCtrlInterval),b.IsIphone||(this._mainCtrlInterval=setTimeout(function(){a.$title.oriHide(),a.$ctrlBar.oriHide(),a.$midModeListCon.oriHide()},200))},c.prototype._showMainCtrl=function(){var a=this;clearInterval(this._mainCtrlInterval),this._mainCtrlInterval=setTimeout(function(){a.$title.oriShow(),a.$ctrlBar.oriShow(),a.$midModeListCon.oriShow()},200)},c.prototype._initMainClick=function(){var a=this;this._mainCtrlInterval=null,this.$ctrlCon.on(b.END_EVENT,function(){($.isUndefined(a.adv)||a.adv.isMediaPlayed)&&("block"===a.$midPlay.css("display")&&a._playOrPause("play"),"none"===a.$ctrlBar.css("display")?(a._showMainCtrl(),clearTimeout(a._hideMainCtrlTime),a._hideMainCtrlTime=setTimeout(function(){
a._hideMainCtrl()},3e3)):a._hideMainCtrl())})},c.prototype._initControls=function(){this._initCtrlProgress(),this._initCtrlButton(),this._initModeSelect(),this._initMainClick(),this._initCtrlFullscreen()}}),svp.define("player.cooperation",function(a){"use strict";var b=svp.$,c=a("player.mediaPlayer"),d=a("base.special");c.prototype._cooperatorVideoAttr=function(a){var c=this,e=function(){var a=c.cache.oriUrls.m3u8,d="";if(0===a[c.cache.modeType].length){var e=["nor","hig","sup"];b.each(e,function(b,c){return 0!==a[c].length?(d=a[c][0],!1):void 0})}else d=a[c.cache.modeType][0];if(""!==d&&c.$video.attr("data-playUrl",d),!b.isUndefined(c.videoData.urls.downloadUrl)&&!b.isUndefined(c.videoData.urls.downloadUrl[0])){var f=c.videoData.urls.downloadUrl[0];c.$video.attr("data-downloadUrl",f)}};d.isCooperator()&&(b.isNumber(a)&&a>0?setTimeout(function(){e()},3e3):e())}}),svp.define("player.ctrlButton",function(a){"use strict";var b=a("base.vars"),c=a("player.mediaPlayer");c.prototype._showPlayBtn=function(){this.$ctrlPlay.oriShow(),this.$ctrlPause.oriHide()},c.prototype._showMidPlayBtn=function(){this._hideLoading(),this._hideMainCtrl(),this.$ctrlBar.oriHide(),this.$midModeListCon.oriHide(),this.$mid.oriShow(),this.$midPlay.oriShow(),this.$title.oriHide()},c.prototype._showPauseBtn=function(){this.$ctrlPlay.oriHide(),this.$ctrlPause.oriShow()},c.prototype._showLoading=function(){b.IsIOS&&(b.IsQQBrowser||b.IsUCBrowser)||(b.IsBaiduBrowser||this.$midPlay.oriHide(),this.$loading.oriShow(),this.$mid.oriHide())},c.prototype._hideLoading=function(){b.IsBaiduBrowser||this.$midPlay.oriHide(),this.$loading.oriHide()};var d=function(a){a.$midPlay.on(b.END_EVENT,function(){return $(this).oriHide(),a._playOrPause("play"),!1})},e=function(a){a.$ctrlPlay.on(b.END_EVENT,function(){return a._playOrPause("play"),!1}),a.$ctrlPause.on(b.END_EVENT,function(){return a._playOrPause("pause"),!1}),a._addEvent("pause",function(){(!b.IsAndroid||$.isUndefined(a.adv)||a.adv.isMediaPlayed)&&(a._hideLoading(),a._showPlayBtn(),a._showMainCtrl())}),b.IsIphone||(a._addEvent("play",a._showPauseBtn),a._addEvent("playing",a._showPauseBtn))};c.prototype._initCtrlButton=function(){d(this),e(this)}}),svp.define("player.ctrlFullscreen",function(a){"use strict";var b=a("base.vars"),c=a("player.mediaPlayer");c.prototype._isSupportSysFullScreen=function(){var a=!1,b=this.videoTag;return b.requestFullscreen?a=!0:b.mozRequestFullScreen?a=!0:b.webkitRequestFullscreen?a=!0:b.webkitEnterFullscreen?a=!0:b.msRequestFullscreen&&(a=!0),$(this.videoTag).hasClass("inline_player")&&!$.isEmpty(this.cache.fullscreenType)&&"1"!==this.cache.fullscreenType&&(a=!1),a},c.prototype._apiEnterFullScreen=function(a){a.requestFullscreen?a.requestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullscreen?a.webkitRequestFullscreen():a.webkitEnterFullscreen?a.webkitEnterFullscreen():a.msRequestFullscreen&&a.msRequestFullscreen()},c.prototype._apiExitFullScreen=function(a){a.exitFullscreen?a.exitFullscreen():a.mozCancelFullScreen?a.mozCancelFullScreen():a.webkitExitFullscreen?a.webkitExitFullscreen():a.webkitCancelFullScreen?a.webkitCancelFullScreen():a.msExitFullscreen&&a.msExitFullscreen()},c.prototype._enterSysFullScreen=function(){var a=this;!b.UA.match(/HS\-U950|HUAWEI_C8812|vivo/i)||b.IsUCBrowser||b.IsQQBrowser||a.videoTag.play();var c=function(){a.videoTag.paused&&!b.IsIOS&&setTimeout(function(){a.videoTag.play()},0)};if(this._isSupportSysFullScreen()){var d=a.videoTag;document.addEventListener("fullscreenchange",c,!1),document.addEventListener("mozfullscreenchange",c,!1),document.addEventListener("webkitfullscreenchange",c,!1),document.addEventListener("MSFullscreenChange",c,!1),a._apiEnterFullScreen(d)}setTimeout(function(){a.videoTag.play()},0)},c.prototype._exitSysFullScreen=function(){var a=this,b=a.videoTag;a._apiExitFullScreen(b)},c.prototype._fullOrShrink=function(a){var c=this;clearTimeout(this._hideMainCtrlTime),"fullScreen"===a?"1"===this.cache.fullscreenType?this._enterSysFullScreen():(b.IsIphone||b.IsOldWindowsPhone||b.IsAndroid&&b.IsQQBrowser||b.IsBaiduBrowser?this._playOrPause("play"):($("html").addClass("position_fullscreen"),this._scrollTop=$(window).scrollTop(),this.$ctrlFullScreen.oriHide(),this.$ctrlShrinkScreen.oriShow()),$(".finPic").oriHide()):($("html").removeClass("position_fullscreen"),this.$ctrlFullScreen.oriShow(),this.$ctrlShrinkScreen.oriHide(),$(window).scrollTop(this._scrollTop),setTimeout(function(){$(".finPic").oriShow()},500)),this._hideMainCtrlTime=setTimeout(function(){c._hideMainCtrl()},3e3)};var d=function(a){a.$ctrlFullScreen.on(b.END_EVENT,function(){return a._fullOrShrink("fullScreen"),!1}),a.$ctrlShrinkScreen.on(b.END_EVENT,function(){return a._fullOrShrink("shrinkScreen"),!1})};c.prototype._initCtrlFullscreen=function(){d(this)}}),svp.define("player.ctrlHd",function(a){"use strict";var b=svp.$,c=a("base.vars"),d=a("player.mediaPlayer"),e=window.ClickTrace=a("trace.click"),f=a("data.appDownload"),g=a("base.action"),h=function(a){a.$midModeListCon.on(c.END_EVENT,function(){var c=b(this);return c.hasClass("show_list")?c.removeClass("show_list"):c.addClass("show_list"),clearTimeout(a._hideMainCtrlTime),!1})},i=function(a){a.$midModeLi.on(c.END_EVENT,function(){var c=b(this);a._changeModeFlag=!0;var d=c.attr("data-mode"),f=c.html();if("app"!==d){var g=a.$midCurMode.attr("data-mode"),h=a.$midCurMode.html();a.$midCurMode.attr("data-mode",d).html(f),c.attr("data-mode",g).html(h)}return a.$midModeListCon.removeClass("show_list"),e.pingback(null,"video_play_code"),a.playByMode(d),a._hideMainCtrlTime=setTimeout(function(){a._hideMainCtrl()},3e3),!1})};d.prototype.playByMode=function(a){var d=this,e=this.cache;if(!b.isUndefined(a)&&e.modeType!==a||c.IsWeixinBrowser)if("app"===a){var h=g.parserAttributes();h.action="1.1",h.type="click",g.sendAction(h),f.gotoDownload()}else b.each(e.modeTypeList,function(b,f){if(f===a){d._pause();var g=d.currentTime,h=e.srcList[a][0].url;return e.curPlayUrl=h,e.curIndex=0,e.modeType=a,d.setSrc(h),c.IsIphone&&c.IsUCBrowser?d.play():setTimeout(function(){d.seekTo(g),d.play(),(c.IsUCBrowser||c.IsQQBrowser)&&d.$video.oriShow()},100),!1}})},d.prototype._initModeSelect=function(){this._changeModeFlag=!1,h(this),i(this)}}),svp.define("player.ctrlProgress",function(a){"use strict";var b=svp.$,c=a("player.mediaPlayer"),d=a("base.vars"),e=a("player.playHistory"),f=a("trace.video"),g=a("base.console"),h=a("player.errorTypes"),i=(a("trace.click"),a("data.appDownload")),j=function(a){var c=a.cache,e=c.srcList[c.modeType]||[],f=a.androidAdv;if(!b.isUndefined(f)&&!f.isMediaPlayed&&d.IsUCBrowser&&d.IsVivoPhone)return a.videoTag.currentTime;if(e.length>1){var g=a.videoTag.currentTime,h=c.curIndex;return b.each(e,function(a,b){return h>a?void(g+=b.duration||0):!1}),g}return a.videoTag.currentTime},k=function(a){var b=a.videoData,c=a.cache;if(0!==a.currentTime&&!c.isMediaAdContent&&!a._makeHistoryFlag){var d={sid:b.sid,vid:b.vid,site:b.site,cid:b.cid,playTime:a.currentTime,duration:b.totalDuration,title:b.tvname||""};if(c.isMediaAdContent){if(null!==history&&0!==history.flag)return;d.flag="0",d.playTime=1}e.setHistory(d),a._makeHistoryFlag=!0,setTimeout(function(){a._makeHistoryFlag=!1},1e3)}},l=function(a){var b=a.videoData;if(a.cache.isRemHistory){var c={vid:b.vid,site:b.site},d=e.getHistory(c),f=null;d.length>0&&(f=d[0],g.log("prgress:",f.playTime),a.seekTo(f.playTime)),a._playByHistoryFlag=!0}},m=function(a){a._addEvent("timeupdate",function(){a._sendVVFlag||(g.log("统计: vv"),f.vv(),a._sendVVFlag=!0),!svp.debug.isShowPlayerPlayStartTime&&a.currentTime>0&&(g.log("视频加载时间:"+(Date.now()-svp.debug.playerPlayStartTime)/1e3+"秒"),svp.debug.isShowPlayerPlayStartTime=!0);var c=a.cache;""===a.videoData.totalDuration&&a.videoTag.duration&&(c.duration=a.videoData.duration=a.videoData.totalDuration=a.videoTag.duration);var e=a.duration=c.duration,m=a.currentTime=j(a);if(c.timeLimit>0&&m>=c.timeLimit&&(b.isUndefined(a.adv)||!b.isUndefined(a.adv)&&a.adv.isMediaPlayed))return a.$video.remove(),void a._showMsg({text:h.SUPPORT[304],btns:{btnA:{text:"立即下载",callback:function(){i.gotoDownload()}}}});if(m>0){if(d.IsIphone||a.hidePoster(),a._hideLoading(),!b.isUndefined(a.adv)&&!a.adv.isMediaPlayed)return;if(m>1){a._sendRealVVFlag||(g.log("统计: reallvv"),f.realVV(a._startPlayTime),a._sendRealVVFlag=!0,a.$video.attr("data-adover","true"),a._cooperatorVideoAttr()),c.isRemHistory&&(a._playByHistoryFlag||l(a),k(a)),m>0&&Math.abs(m-a._lastCurTime)>2&&(a._startPlayTime=b.now()),(d.IsIphone||d.IsOldWindowsPhone)&&a.$midModeList.oriHide(),a._lastCurTime=m,!a._sendEndFlag&&m>e-15&&(g.log("统计: ended"),f.ended(m,this._bufferCount),a._sendEndFlag=!0),null===a._traceHeartInterval&&(a._traceHeartInterval=setInterval(function(){g.log("统计: heart"),f.heart(a.currentTime)},12e4)),a._changeModeFlag=!1,a._dragRangeFlag=!1,a._firstWaitingFlag=!1,a._mediaAdOverFlag=!0,d.IsIphone||d.IsOldWindowsPhone||/Android\/?\s?2\../i.test(d.UA)||d.IsQQBrowser||d.IsUCBrowser?a._showPlayBtn():d.IsIphone||d.IsIpad||a._showPauseBtn();var n=m/e*100+"%";if(m>=e&&c.timeLimit===e){m=e,n="100%";var o=c.timeLimit,p=(o-o%60)/60;p=o%60===0?p:p+1}m>e&&(m=e),a.$ctrlCurTime.html(b.formatSeconds(m)),a.$ctrlDuration.html(b.formatSeconds(e)),a._dragFlag||a.$ctrlCurPlayedBar.css({width:n}),d.IsUCBrowser&&d.IsIphone&&parseInt(m,10)===parseInt(e,10)&&a._fireEvent("ended")}}})},n=function(a){a.$ctrlDragAnchor.on(d.START_EVENT,function(b){return clearTimeout(a._hideMainCtrlTime),clearTimeout(a._rewindForwardInterval),a.$midRewindForwardCon.oriShow(),a._dragFlag=!0,a._dragRangeFlag=!0,a._touchStratX=b.touches&&b.touches[0]?b.touches[0].pageX:b.pageX,!1}),a.$ctrlDragAnchor.on(d.MOVE_EVENT,function(c){if(a._dragFlag){var d=a.$ctrlTrackBar.width(),e=a.duration,f=a.currentTime;clearTimeout(a._hideMainCtrlTime),clearTimeout(a._rewindForwardInterval);var g=function(c,d){a.$mid.oriShow(),f>c?a.$midRewindForwardCon.addClass("rewind").removeClass("forward"):a.$midRewindForwardCon.addClass("forward").removeClass("rewind"),a._moveTime=c,a.$midTime.html(b.formatSeconds(c)),a.$ctrlCurPlayedBar.width(c/d*100+"%")};a._touchMoveX=c.touches&&c.touches[0]?c.touches[0].pageX:c.pageX;var h=e/d*(a._touchStratX-a._touchMoveX)*-1,i=f+h;0>i?g(0,e):i>e?g(e,e):g(i,e)}return!1}),a.$ctrlDragAnchor.on(d.END_EVENT+" mouseout",function(){return a._dragFlag&&(a._dragFlag=!1,a.seekTo(a._moveTime),a._startPlayTime=b.now(),a._rewindForwardInterval=setTimeout(function(){a.$midRewindForwardCon.oriHide()},2e3),a._hideMainCtrlTime=setTimeout(function(){a._hideMainCtrl()},3e3)),!1})},o=function(a){a.$ctrlBar.on(d.END_EVENT,function(){return!1}),a.$ctrlTrackBar.on(d.START_EVENT,function(c){var d=b(this),e=c.touches&&c.touches[0]?c.touches[0].pageX:c.pageX,f=e-d.offset().left,g=d.width(),h=a.duration/g*f;return a._startPlayTime=b.now(),a.seekTo(h),!1})};c.prototype._initCtrlProgress=function(){this._sendRealVVFlag=!1,this._sendEndFlag=!1,this._playByHistoryFlag=!1,this._makeHistoryFlag=!1,this._lastCurTime=0,this._startPlayTime=0,this._bufferCount=0,this._traceHeartInterval=null,this._rewindForwardInterval=null,this._dragRangeFlag=!1,this._changeModeFlag=!1,this._mediaAdOverFlag=!1,this._firstWaitingFlag=!0,this._dragFlag=!1,this._touchStratX=0,this._touchMoveX=0,this._moveTime=-1,m(this),"live"!==this.config.mediaType&&(n(this),o(this))}}),svp.define("player.dataService",function(a,b,c){"use strict";var d=svp.$,e=a("data.videoInfo"),f=a("data.liveInfo"),g=a("data.copyright"),h=a("player.errorTypes"),i=function(a,b){var c={};c.site=a.site,c.liveId=d.isUndefined(a.liveId)?d.getUrlParam("liveId")||"147":a.liveId,f.getData(c,function(a){g.check(a,function(c){var d={};d.code=c.code||"",d.msg=c.msg||"",d.data=a,b(d)})})},j=function(a,b){if(!d.isUndefined(a.fee)&&0!=a.fee||!d.isUndefined(a.h5Limit)&&a.h5Limit>0||!d.isUndefined(a.mobileLimit)&&2==a.mobileLimit||!d.isUndefined(a.ipLimit)&&1==a.ipLimit)g.check(a,function(c){var d={};d.code=c.code||"",d.msg=c.msg||"","200"!==d.code?(d.data=a,b(d)):e.getData(a,function(a){d.data=a,b(d)})});else{var c={};c.vid=a.vid,c.site=a.site,e.getData(c,function(a){g.check(a,function(c){var d={};d.code=c.code||"",d.msg=c.msg||"",d.data=a,b(d)})})}},k=function(a,b){var c={aid:a.aid||"",areaId:a.areaId||6,cateCode:a.cateCode||"",channeled:a.channeled||"",cid:a.cid||"",durations:Object,hike:a.hike||"1",horHighPic:a.poster||"",hor_big_pic:a.poster||"",hor_high_pic:a.poster||"",plid:a.plid||"",sid:a.sid||"",site:a.site||2,totalDuration:a.duration||"",tvid:a.tvid||"",tvname:a.title||"",urls:{downloadUrl:[a.src],m3u8:[],mp4:[]},verHighPic:a.poster||"",ver_high_pic:a.poster||"",vid:a.vid||"source",videoName:a.title||"",video_name:a.title||"",video_src:a.src||""},d={};d.code="200",d.msg=h.PROCESS[200]||"",d.data=c,b(d)},l={auto:function(a,b){d.isUndefined(a)&&alert("数据错误"),b=d.isFunction(b)?b:function(){},d.isUndefined(a.liveId)?d.isUndefined(a.vid)?d.isUndefined(a.src)?alert("非法数据结构"):k(a,b):j(a,b):i(a,b)},video:j,live:i,source:k};c.exports=l}),svp.define("player.errorTypes",function(a,b,c){"use strict";var d={COPYRIGHT:{100:"您所在的国家或地区，不在所播放的节目版权范围",101:"该视频版权已到期，无法观看"},PROCESS:{200:"数据处理完成",201:"无效数据,请刷新重试",202:"无效视频数据",203:"数据结构错误",204:"解析数据出错"},SUPPORT:{300:"您的浏览器不支持播放功能，请使用搜狐视频客户端",301:"该视频目前只支持5分钟观看，观看完整视频，请使用搜狐视频客户端",302:"UC浏览器不支持播放功能，建议使用系统浏览器或请使用搜狐视频客户端",303:"直播请使用搜狐视频客户端",304:"本片仅供试看，如果需要观看更多内容，请下载搜狐视频App",305:"您的浏览器不支持直播功能，请使用搜狐视频客户端"},REQUEST:{400:"网络超时，请刷新重试"}};c.exports=d}),svp.define("player.events",function(a){"use strict";var b=svp.$,c=a("player.mediaPlayer"),d=a("base.vars"),e=a("base.special"),f=(a("base.console"),a("player.errorTypes")),g=(a("trace.click"),a("data.appDownload"));c.prototype.on=function(a,b){var c=this;this._onDomLoaded(function(){"ended"===a||"onended"===a?c.eventProcess.userEnded.push({name:"ended",process:function(){b.call(c)}}):c.$video.on(a,function(a){b.call(c,a)})})},c.prototype.off=function(a,b){var c=this;this._onDomLoaded(function(){a=a.toLowerCase(),c.$video.off(a,b)})},c.prototype.trigger=function(a){var b=this;this._onDomLoaded(function(){a=a.toLowerCase(),b.$video.trigger(a)})},c.prototype.one=function(a,b){var c=this;this._onDomLoaded(function(){a=a.toLowerCase(),"ended"===a?this.$video.on(a,function(){c.cache.curIndex===c.cache.totCounts-1&&c.$video.one(a,function(a){b.call(c,a)})}):this.$video.one(a,function(a){b.call(c,a)})})},c.prototype._addEvent=function(a,c,d){var f=this.eventProcess,g=this;if(a=a.toLowerCase(),!b.isUndefined(a)&&!b.isUndefined(f[a])){var h={},i=e.isAllowTimeupdateReplaceEnded()&&("ended"===a||"onended"===a);b.isFunction(c)?(i?(a="timeupdate",h.process=function(){g.videoTag.duration-g.videoTag.currentTime<.5&&c.call(g)}):h.process=function(){c.call(g)},h.name="_"+a+(new Date).getTime(),f[a].push(h)):b.isString(c)&&b.isFunction(d)&&(h.process=i?function(){g.videoTag.duration-g.videoTag.currentTime<.5&&d.call(g)}:function(){d.call(g)},h.name=c,f[a].push(h))}},c.prototype._removeEvent=function(a,c){var d=this.eventProcess;b.isUndefined(a)||b.isUndefined(d[a])||(b.isUndefined(c)?d[a]=[]:b.isString(c)&&b.each(d[a],function(b,e){e.name===c&&d[a].splice(b,1)}))},c.prototype._fireEvent=function(a){var c=this.eventProcess,d=this;b.isUndefined(a)||b.isUndefined(c[a])||b.each(c[a],function(a,b){b.process.call(d)})},c.prototype._onBaseEnded=function(){var a=this,c=a.cache;if(this._startPlayTime=b.now(),this._bufferCount=0,-1===c.curIndex&&(c.curIndex=0),d.IsBaiduBrowser||d.IsBaiduBoxApp){var e=c.srcList[c.modeType],h=0;if(b.each(e,function(a,b){return h+=b.duration,a>=c.curIndex?!1:void 0}),c.timeLimit>0&&h>=c.timeLimit&&(b.isUndefined(a.adv)||!b.isUndefined(a.adv)&&player.adv.isMediaPlayed))return a.pause(),a.$video.remove(),void a._showMsg({text:f.SUPPORT[304],btns:{btnA:{text:"立即下载",callback:function(){g.gotoDownload()}}}})}var i=c.getNextUrl();if(""!==i)this.trigger("waiting"),c.curPlayUrl=i,c.curIndex++,this.setSrc(c.curPlayUrl),setTimeout(function(){a.videoTag.play()},100),this.videoData.video_src=i;else{if(c.loop&&!c.isMediaAdContent){this.trigger("waiting");var j=c.getFirstUrl();this.setSrc(j),this.play(),c.curPlayUrl=j,c.curIndex=-1,this.videoData.video_src=j}else c.curPlayUrl=i;b.isUndefined(this.adv)||this.adv.isMediaPlayed||!d.IsAndroid?b.each(this.eventProcess.userEnded,function(a,b){b.process()}):this.trigger("advended")}this._nextPreLoadImg=null},c.prototype._onKeyDown=function(a,c){var d=a.keyCode||a.which||a.charCode,e=function(a){var b=c.getVolume();b+=a,c.setVolume(b)};if(!b.isUndefined(d))switch(d){case 38:e(.1);break;case 40:e(-.1);break;case 37:c.seekTo(c.currentTime-10);break;case 39:c.seekTo(c.currentTime+10)}},c.prototype._initEvent=function(){var a=this,c=this.eventProcess;this.$video&&this.$video.length>0&&b.each(a.eventList,function(e,f){b.isArray(c[f])&&(d.IsSAMSUNGNote3&&"ended"!==f||!d.IsSAMSUNGNote3)&&a.$video.on(f,function(d){b(a.$video,a.$main).length>0&&b.each(c[f],function(b,c){c.process.call(a,d)})})}),this._addEvent("ended",this._onBaseEnded),b("body").on("keydown",function(b){a._onKeyDown(b,a)})}}),svp.define("player.exception",function(a){"use strict";var b=svp.$,c=a("player.mediaPlayer"),d=a("base.vars"),e=a("trace.click"),f=a("base.util");c.prototype._sendException=function(a){e.pingback(null,"foxplayer",a)};var g=function(a){if(/Win32|Win64|Windows|Mac68K|MacPC|Macintosh|MacIntel/i.test(window.navigator.platform))return!1;if(/2g|3g/i.test(f.getConnectionType()))return!1;var c=a.cache;a._sendException({}),d.IsIOS?a.trigger("ended"):d.IsAndroid&&(c.curIndex<c.totCounts?(a.pause(),a._showLoading(),a.cache.curPlayUrl=a.cache.getNextUrl(),a.setSrc(a.cache.curPlayUrl),c.curIndex++,a.play()):!b.isUndefined(a.adv)&&a.adv.isMediaPlayed?a.adv.gotoEnd():a.trigger("ended"))},h=function(a){a._addEvent("error",function(){g(a)})},i=function(){};c.prototype._initException=function(){h(this),i(this)}}),svp.define("player.flash",function(a,b,c){var d=svp.$,e=a("base.vars"),f=a("base.console"),g=a("player.mediaPlayer"),h=a("player.settings"),i=(a("base.special"),a("trace.video"),a("player.errorTypes"),a("base.cookie")),j=(a("trace"),a("trace.video")),k=(a("trace.click"),a("player.dataService")),l=e.IsIEBrowser;g.prototype._init=function(a){this._initAdvFlag=!1,this._hideMainCtrlTime=null,this._firstLoadFlag=!0,this._dataTimeout=3e3,this.config=h.initConfig(a);var b={},c=this.config.data||{};b=d.isArray(c.videoDataList)&&c.videoDataList.length>0?c.videoDataList[0]:d.isArray(c.vidList)&&c.vidList.length>0?{vid:c.vidList[0],site:c.site||"1"}:c,this.localFlashData=b,this.config.share=this.config.share?!0:!1,this.vrsPlayer=null,this.swfObj=null,this.flashEmbed="",this.pluginsvars="",f.log(this.config)},g.prototype.htmlTo=function(a){a=d(a);var b=this;this.$parentDom=a||d(".sohu_player"),this.$player=d("#"+this.config.mainId),this._getDataFlag=!1,k.video(this.localFlashData,function(a){"200"!==a.code||d.isUndefined(a.data)?f.log("数据无效"):b.localFlashData=a.data});b.MakeFlashPlayer(b.config.share,b.localFlashData);return window.swfGotoNewPage=function(){},b},window.Trace.flashOnPlay=function(){f.log("flash onplay")},window.Trace.flashOnPlayed=function(){f.log("flash onPlayed")},window.Trace.flashOnStop=function(){f.log("flash onstop")},window.Trace.flashOnPause=function(){f.log("flash onPause")},g.prototype.MakeFlashVideoVars=function(a,b){var c=this,d="&imgCutBtn=1&showRecommend=1&autoplay=true&sogouBtn=0&shareBtn=1&topBarFull=0&datashare=0&topBar=0&topBarNor=0&skin=0&skinNum=1&topBarFull=0&downloadBtn=1&domain=inner&oad=&ead=&pad=&showTipHistory=0&seekTo=0&jump=0&isWriteComm=0";try{var f=b.site||"1",g=b.cid||"";d="9001"==g||"2"==f?d+"&id="+(b.vid||""):d+"&vid="+(b.vid||""),d=d+"&pageurl="+encodeURI(location.href),d=d+"&nid="+(b.nid||""),d=d+"&sid="+(i.get("SUV")||b.sid||""),d=d+"&api_key="+e.API_KEY,c.pluginsvars=d}catch(h){}return d},g.prototype.getFlashVersion=function(){var a,b=0;if(l)a=new ActiveXObject("ShockwaveFlash.ShockwaveFlash"),a&&(b=parseInt(a.GetVariable("$version").split(" ")[1].split(",")[0],10));else{var c=window.navigator.plugins;if(c&&c.length>0&&(a=c["Shockwave Flash"]))for(var d=a.description.split(" "),e=0,f=d.length;f>e;e++){var g=parseInt(d[e],10);if(!isNaN(g)){b=g;break}}}return b},g.prototype.MakeFlashPlayer=function(a,b){var c=this,g=c.getFlashVersion(),h="",i=b.vid||a.vid,k=g&&i;if(k){try{{j.vv()}c.vrsPlayer="http://tv.sohu.com/upload/swf/201503161/Main.swf";var m={pluginspage:"http://www.adobe.com/go/getflashplayer",type:"application/x-shockwave-flash",width:"100%",height:"100%",allowfullscreen:"true",allowscriptaccess:"always",wmode:"Opaque",quality:"high",shareBtn:"0",skinNum:"1",api_key:e.API_KEY,src:c.vrsPlayer},n=c.MakeFlashVideoVars(a,b),o=[];l&&o.push('<object width="100%" height="100%" >'),o.push('<embed id="sohuplayer"');for(var p in m)o.push(" "+p+'="'+m[p]+'"');o.push(' flashvars="'+n+'" '),o.push("></embed>"),l&&o.push("</object>"),h=o.join(""),f.log("@@@@ makeFlashHtml flashEmbed ",h),c.flashEmbed=h,c.$parentDom.addClass("sohuplayer"),d(c.$parentDom).html(h),j.realVV()}catch(q){f.log(q)}return!0}return!1},g.prototype.MakeFlashSwfObjPlayer=function(a,b){var c=this,g=c.getFlashVersion(),h="",k=b.vid||a.vid,l=g&&k;return l?(svp.seajs.jsLoader("http://js.tv.itc.cn/base/plugin/swfobject_97e55f.js",function(){var a,g="http://tv.sohu.com/upload/swf/201503161/Main.swf";"9001"==b.cid||"2"==b.site?(g=g+"?id="+k+"&imgCutBtn=1&showRecommend=1&autoplay=true&sogouBtn=0&shareBtn=1&topBarFull=0&datashare=0&topBar=0&topBarNor=0&skin=0&skinNum=1&topBarFull=0&downloadBtn=1&domain=inner&oad=&ead=&pad=&showTipHistory=0&seekTo=0&jump=0&isWriteComm=0&api_key="+e.API_KEY,a=new SWFObject(g,"sohuplayer","100%","100%","9,0,115","#000000")):(a=new SWFObject(g,"sohuplayer","100%","100%","9,0,115","#000000"),a.addVariable("skinNum","1"),a.addVariable("pageurl",location.href),a.addVariable("vid",b.vid||""),a.addVariable("pid",b.pid||""),a.addVariable("nid",""),a.addVariable("seekTo","0"),a.addVariable("jump","0"),a.addVariable("autoplay","true"),a.addVariable("showRecommend","0"),a.addVariable("sid",i.get("SUV")||b.sid||""),a.addVariable("api_key",e.API_KEY)),a.addParam("wmode","Opaque"),a.addParam("quality","high"),a.addParam("allowscriptaccess","always"),a.addParam("allowfullscreen","true"),a.addParam("width","100%"),a.addParam("height","100%"),h=a.getFlashHtml(),c.swfObj=a,f.log("@@@@ MakeFlashSwfObjPlayer flashEmbed ",h),c.flashEmbed=h,f.log(c.swfObj),c.$parentDom.addClass("sohuplayer"),d(c.$parentDom).html(h),j.realVV()}),!0):!1},c.exports=g}),svp.define("player.foxPlayer",function(a,b,c){"use strict";a("player.events"),a("player.adv"),a("player.controls"),a("player.update"),a("player.poster"),a("player.message"),a("player.videoList"),a("player.cooperation"),a("player.exception"),a("player.showRecommend");var d=svp.$,e=a("base.vars"),f=a("base.console"),g=a("player.mediaPlayer"),h=a("player.html5UI"),i=a("player.settings"),j=a("trace.video"),k=a("player.errorTypes");g.prototype._init=function(a){this._initAdvFlag=!1,this._hideMainCtrlTime=null,this._firstLoadFlag=!0,this._dataTimeout=3e3,this._showRecommendFlag=!1,this._sendVVFlag=!1,this.config=i.initConfig(a),this._sendPlayDisplayCompleteFlag=!1},g.prototype.htmlTo=function(a){if(a=d(a),a.length>0){var b=this;if(this.$parentDom=a,d.isUndefined(this.$player)){svp.debug.playerLoadDomStartTime=Date.now(),a.html(h.makeLoadingTmpl(this.config)),f.log("加载loading完成, 耗时--->"+(Date.now()-svp.debug.playerLoadDomStartTime)/1e3),this.$player=d("#"+this.config.mainId),this.$playerLoading=d("#"+this.config.mainId+" .svp_player_loading"),this._getDataFlag=!1;var c=this.config.data;if(d.isUndefined(c))b._showMsg({text:k.PROCESS[202]});else if(d.isUndefined(c.vidList)&&d.isUndefined(c.videoDataList)){var e={videoDataList:[c]};this.videoList=this._videoList(e),this.updateMedia(c)}else{var g,i=this.videoList=this._videoList(c);try{g="vidList"===i.type?{vid:i.vidList[i.curIndex],site:i.site}:i.videoDataList[i.curIndex]}catch(j){b._showMsg({text:k.PROCESS[204]})}this.updateMedia(g)}}else this.$parentDom.html(this.$main),this.cache.autoplay&&this._playOrPause("play")}},g.prototype._initDoms=function(){var a="#"+this.config.mainId;this.$main=d(a),this.$loading=d(a+" .svp_player_loading"),this.$loadingDesc=d(a+" .svp_player_loading_notice"),this.$video=d(a+" #"+this.config.elemId),this.videoTag=d(a+" #"+this.config.elemId)[0],this.$titleCon=d(a+" .svp_title"),this.$title=d(a+" .svp_title_content"),this.$posterCon=d(a+" .svp_poster"),this.$posterRight=d(a+" .svp_poster_right"),this.$posterAdTime=d(a+" .svp_poster_ad_time"),this.$mid=d(a+" .svp_mid"),this.$midPlay=d(a+" .svp_mid_play"),this.$midRewindForwardCon=d(a+" .svp_mid_rewind_forward"),this.$midTime=d(a+" .svp_mid_time"),this.$midModeListCon=d(a+" .svp_mid_mode"),this.$mideCurModeBtn=d(a+" .svp_mid_cur_mode_btn"),this.$midCurMode=d(a+" .svp_mid_cur_mode"),this.$midModeList=d(a+" .svp_mid_mod_list"),this.$midModeLi=d(a+" .svp_mid_mod_list li"),this.$ctrlCon=d(a+" .svp_ctrl"),this.$ctrlBar=d(a+" .svp_ctrl_bar"),this.$ctrlPlay=d(a+" .svp_ctrl_play"),this.$ctrlPause=d(a+" .svp_ctrl_pause"),this.$ctrlBuffer=d(a+" .svp_ctrl_buffer"),this.$ctrlPointsCon=d(a+" .svp_ctrl_points"),this.$ctrlCurPlayedBar=d(a+" .svp_ctrl_played_bar"),this.$ctrlTime=d(a+" .svp_ctrl_time"),this.$ctrlCurTime=d(a+" .svp_ctrl_cur_time"),this.$ctrlDuration=d(a+" .svp_ctrl_duration"),this.$ctrlDragAnchor=d(a+" .svp_ctrl_drag_anchor"),this.$ctrlTrackBar=d(a+" .svp_ctrl_track_bar"),this.$ctrlScreen=d(a+" .svp_ctrl_screen"),this.$ctrlFullScreen=d(a+" .svp_ctrl_full_screen"),this.$ctrlShrinkScreen=d(a+" .svp_ctrl_shrink_screen"),this.$maskLayer=d(a+" .svp_mask_layer"),this.$pauseAdCon=d(a+" .svp_ad_pause"),this.$pauseAdCloseBtn=d(a+" .svp_ad_pause_close")},g.prototype._playOrPause=function(a){var b=this;svp.debug.playerPlayStartTime=Date.now(),clearTimeout(this._hideMainCtrlTime),"pause"===a?(this._pause(),e.IsNewWindowsPhone?setTimeout(function(){b._showPlayBtn()},300):this._showPlayBtn(),this._showMainCtrl()):(this._initAdvFlag||(this.adInit(),this._initAdvFlag=!0),this.adv&&this._adUpdateFlag&&(this.adv.updateAdv(this),this._adUpdateFlag=!1),(!this.adv||this.adv.isMediaPlayed)&&this._showMainCtrl(),!this._sendVVFlag&&(e.IsBaiduBrowser||e.IsBaiduBoxApp||e.IsIOS&&(e.IsQQBrowser||e.IsUCBrowser))&&(f.log("统计: vv"),j.vv(),this._sendVVFlag=!0),!this._sendRealVVFlag&&((/QQBrowser\/5\./i.test(e.UA)||e.IsUCBrowser)&&e.IsIOS||(d.isUndefined(this.adv)||this.adv.isMediaPlayed)&&e.IsBaiduBoxApp)&&(f.log("统计: reallvv"),j.realVV(this._startPlayTime),this._sendRealVVFlag=!0,this.$video.attr("data-adover","true"),this._cooperatorVideoAttr()),(e.IsUCBrowser||e.IsQQBrowser)&&this.$video.oriShow(),(/UCBrowser\/9\./i.test(e.UA)||e.IsSonyPhone||e.IsVivoPhone||e.IsUCBrowser)&&e.IsAndroid?setTimeout(function(){b._play()},50):e.IsWindowsPhone?setTimeout(function(){b._play()},300):!this._firstLoadFlag&&e.IsIOS&&e.IsQQBrowser?setTimeout(function(){b._play()},50):this._play(),this._startPlayTime=d.now(),this._hideMainCtrlTime=setTimeout(function(){b._hideMainCtrl()},3e3),this._firstLoadFlag?(e.IsIphone||e.IsBaiduBrowser||!this.cache.autoplay||(this.$midPlay.oriShow(),this._showPlayBtn(),this.showPoster()),this._firstLoadFlag=!1):e.IsBaiduBrowser?this._hideLoading():this._showLoading(),(e.IsIphone||e.IsOldWindowsPhone||e.IsQQBrowser||e.IsBaiduBrowser)&&this._showMidPlayBtn(),e.IsIphone&&(e.IsUCBrowser||e.IsQQBrowser)&&this._showMainCtrl())},g.prototype._autoNextVideoService=function(){var a=this;a.config.isShowRecommend&&(a._showRecommendFlag=!0,this.on("ended",function(){setTimeout(function(){if(a._showRecommendFlag){f.log("显示相关推荐");var b=a.videoList,c=b.curIndex,d=null;"vidList"===b.type&&c<b.vidList.length-1?(b.curIndex++,d={vid:b.vidList[b.curIndex],site:b.site}):"videoDataList"===b.type&&c<b.videoDataList.length-1&&(b.curIndex++,d=b.videoDataList[b.curIndex]),f.log("nextVideo"+d),null!==d?a.updateMedia(d,!0):(f.log("showRecommend 11"),a.showRecommend())}},800)}))},c.exports=g}),svp.define("player.html5UI",function(a,b,c){"use strict";{var d=svp.$,e=svp.template,f=a("base.vars"),g=a("base.special"),h=a("player.settings"),i={},j={param:{},model:{},view:{},ctrl:{}},k=(j.param,j.model),l=j.view;j.ctrl}k.parseCache=function(a){var b={title:a.title||"",poster:a.poster||"",pointList:[{left:0}],mainId:a.mainId||"svp_main_1",height:a.height||"100%",width:a.width||"100%",srcType:a.srcType||"mp4",elemId:a.elemId||"",autoplay:a.autoplay||!1,defControls:a.defControls||!1,isInitSrc:!1,isIphone:f.IsIphone||!1,isUCBrowser:f.IsUCBrowser||!1,isQQBrowser:f.IsQQBrowser||!1,curMode:a.modeType||"",curModeName:h.PLAY_MODE[a.modeType],selList:[]};return a.mediaAdPlatform&&g.isAllowPlayAdv()&&(a.mediaAdPlatform.indexOf("ios")>-1&&f.IsIOS||a.mediaAdPlatform.indexOf("android")>-1&&f.IsAndroid)||(b.isInitSrc=!0),d.each(a.modeTypeList,function(a,c){if(c!==b.curMode){var d={mode:c,modeName:h.PLAY_MODE[c]};b.selList.push(d)}}),b},k.parseConfig=function(a){var b={mainId:a.mainId||"svp_main_1",height:a.height||"100%",width:a.width||"100%"};return b},l.videoTag=function(){var a='<div class="video"><% if (srcType === "client") { %><div data-noSupport="noSupport"<% } else { %><video<% } %> id="<%=elemId%>"<% if (autoplay) { %> autoplay<% } %><% if (defControls) { %> controls<% } %> x-webkit-airplay="isHtml5UseAirPlay" data-adover="false"<% if (autoplay) { %> preload="none"<% }%><% if (isInitSrc) { %> src="<%=curPlayUrl%>"<% }%> height="<%=height%>" width="<%=width%>"<% if (isIphone) { %> style="position:absolute; left:-200%;"<% } else if (!autoplay && isUCBrowser) { %> style="display: none;"<% } %>></div>';return a},l.ctrl=function(){var a='<div class="player_controls svp_ctrl"><div class="mid svp_mid"><span class="mid_play svp_mid_play white"><b></b></span><span class="mid_rewind_forward rewind svp_mid_rewind_forward" style="display:none;"><b class="mid_forward"></b><b class="mid_rewind"></b><span class="mid_time svp_mid_time">02:04</span></span></div><div class="slider_bar svp_ctrl_bar"><div class="left_btn_play"><div class="svp_ctrl_play"><b class="state_play"></b></div><div class="svp_ctrl_pause" style="display:none;"><b class="state_pause"></b></div></div><div class="action_trackBar svp_ctrl_track_bar"><% if (!((isUCBrowser || isQQBrowser) && isIphone)) { %><div class="trackbar"><b class="buffered svp_ctrl_buffer"></b><div class="click_area svp_ctrl_click_area"><div class="time_points svp_ctrl_points"><% for (var i = 0, l = pointList.length; i < l; i++) { %><em style="left:<%=pointList[i].left%>"></em><% } %></div></div><b class="played svp_ctrl_played_bar"><em class="handle svp_ctrl_drag_anchor"></em></b></div><% } %></div><% if (!((isUCBrowser || isQQBrowser) && isIphone)) { %><div class="time svp_ctrl_time"><b class="current_time svp_ctrl_cur_time">00:00</b> / <span class="duration svp_ctrl_duration" data-key="totalDuration" data-type="time">00:00</span></div><% } %><div class="controllers svp_ctrl_screen"><div class="fullscreen disabled svp_ctrl_full_screen"><span></span></div><div class="shrinkscreen disabled svp_ctrl_shrink_screen" style="display:none;"><span></span></div></div></div>';return a},l.playMode=function(){var a='<% if (curMode !== "" && selList.length > 0) { %><div class="quality_button quality_container svp_mid_mode<% if (selList.length > 2) { %> smaller<% } %>"><% if (selList.length > 0) { %><div class="quality_definition_button svp_mid_cur_mode_btn"><span class="svp_mid_cur_mode" data-mode="<%=curMode%>"><%=curModeName%></span></div><div class="quality_definition_list"><ul class="svp_mid_mod_list"><% for (var i = 0, l = selList.length; i < l; i++) { %><li data-mode="<%=selList[i].mode%>"><span><%=selList[i].modeName%></span></li><% } %></ul></div><% } %></div><% } %>';return a},l.video=function(){var a='<div class="player_main svp_player_main">'+l.videoTag()+'<div class="video_title svp_title"><strong><span class="svp_title_content title_content"><%=title%></span></strong></div><div class="poster svp_poster" style="background-image:url(<%=poster%>);"></div>'+l.ctrl()+'<div class="ad-img svp_ad_pause"><em class="svp_ad_pause_close"></em></div>'+l.playMode()+'<div class="mask-layer svp_mask_layer" style="display: none;"></div></div>';

return a},l.loading=function(){var a='<div class="player inline_player" id="<%=mainId%>" style="height:<%=height%>; width:<%=width%>"><div class="svp_player_loading player_loading"></div><div class="svp_player_loading_notice player_loading_notice">努力加载中,请稍后...</div></div>';return a},i.makeVideoTmpl=function(a){var b=e.compile(l.video()),c=k.parseCache(a);return b(c)},i.makeLoadingTmpl=function(a){var b=e.compile(l.loading()),c=k.parseConfig(a);return b(c)},c.exports=i}),svp.define("player.liveUI",function(a,b,c){"use strict";{var d=svp.$,e=svp.template,f=a("base.vars"),g=a("base.special"),h=a("player.settings"),i={},j={param:{},model:{},view:{},ctrl:{}},k=(j.param,j.model),l=j.view;j.ctrl}k.parseCache=function(a){var b={title:a.title||"",poster:a.poster||"",pointList:[{left:0}],mainId:a.mainId||"svp_main_1",height:a.height||"100%",width:a.width||"100%",srcType:a.srcType||"mp4",elemId:a.elemId||"",autoplay:a.autoplay||!1,defControls:a.defControls||!1,isInitSrc:!1,isIphone:f.IsIphone||!1,isUCBrowser:f.IsUCBrowser||!1,volume:a.volume||1,curMode:a.modeType||"",curModeName:h.PLAY_MODE[a.modeType],selList:[]};return a.mediaAdPlatform&&g.isAllowPlayAdv()&&(a.mediaAdPlatform.indexOf("ios")>-1&&f.IsIOS||a.mediaAdPlatform.indexOf("android")>-1&&f.IsAndroid)||(b.isInitSrc=!0),d.each(a.modeTypeList,function(a,c){if(c!==b.curMode){var d={mode:c,modeName:h.PLAY_MODE[c]};b.selList.push(d)}}),b},k.parseConfig=function(a){var b={mainId:a.mainId||"svp_main_1",height:a.height||"100%",width:a.width||"100%"};return b},l.videoTag=function(){var a='<div class="video"><% if (srcType === "client") { %><div data-nosupport="noSupport"<% } else { %><video<% } %> id="<%=elemId%>"<% if (autoplay) { %> autoplay<% } %><% if (defControls) { %> controls<% } %> x-webkit-airplay="isHtml5UseAirPlay"<% if (isWeixinBrowser) { %> webkit-playsinline<% } %> data-adover="false"<% if (autoplay) { %> preload="none"<% }%><% if (isInitSrc) { %> src="<%=curPlayUrl%>"<% }%> height="<%=height%>" width="<%=width%>"<% if (isIphone) { %> style="position:absolute; left:-200%;"<% } else if (!autoplay && isUCBrowser) { %> style="display: none;"<% } %> volume="<%=volume%>"></div>';return a},l.ctrl=function(){var a='<div class="player_controls svp_ctrl"><div class="mid svp_mid"><span class="mid_play svp_mid_play white"><b></b></span><span class="mid_rewind_forward rewind svp_mid_rewind_forward" style="display:none;"><b class="mid_forward"></b><b class="mid_rewind"></b><span class="mid_time svp_mid_time">02:04</span></span></div><div class="message"><p></p></div><div class="slider_bar svp_ctrl_bar"><div class="left_btn_play"><div class="svp_ctrl_play"><b class="state_play"></b></div><div class="svp_ctrl_pause" style="display:none;"><b class="state_pause"></b></div></div><div class="action_trackBar svp_ctrl_track_bar"><div class="trackbar"><b class="buffered svp_ctrl_buffer"></b><div class="click_area svp_ctrl_click_area"><div class="time_points svp_ctrl_points"><% for (var i = 0, l = pointList.length; i < l; i++) { %><em style="left:<%=pointList[i].left%>"></em><% } %></div></div><b class="played svp_ctrl_played_bar"><em class="handle svp_ctrl_drag_anchor"></em></b></div></div><div class="time svp_ctrl_time">LIVE</div><div class="controllers svp_ctrl_screen"><div class="fullscreen disabled svp_ctrl_full_screen"><span></span></div><div class="shrinkscreen disabled svp_ctrl_shrink_screen" style="display:none;"><span></span></div></div></div>';return a},l.playMode=function(){var a='<% if (curMode !== "" && selList.length > 0) { %><div class="quality_button quality_container svp_mid_mode"><% if (selList.length > 0) { %><div class="quality_definition_button svp_mid_cur_mode_btn"><span class="svp_mid_cur_mode" data-mode="<%=curMode%>"><%=curModeName%></span></div><div class="quality_definition_list"><ul class="svp_mid_mod_list"><% for (var i = 0, l = selList.length; i < l; i++) { %><li data-mode="<%=selList[i].mode%>"><span><%=selList[i].modeName%></span></li><% } %></ul></div><% } %></div><% } %>';return a},l.video=function(){var a='<div class="player_main svp_player_main">'+l.videoTag()+'<div class="video_title svp_title"><strong><span class="svp_title_content"><%=title%></span></strong></div><div class="poster svp_poster" style="background-image:url(<%=poster%>);background-color:#444;"></div>'+l.ctrl()+'<div class="ad-img svp_ad_pause"><em class="svp_ad_pause_close"></em></div>'+l.playMode()+'<div class="mask-layer svp_mask_layer" style="display: none;"></div></div>';return a},l.loading=function(){var a='<div class="svp_player player inline_player" id="<%=mainId%>" style="height:<%=height%>; width:<%=width%>"><div class="svp_player_loading"></div><div class="svp_player_loading_notice">努力加载中,请稍后...</div></div>';return a},i.makeVideoTmpl=function(a){var b=e.compile(l.video()),c=k.parseCache(a);return b(c)},i.makeLoadingTmpl=function(a){var b=e.compile(l.loading()),c=k.parseConfig(a);return b(c)},c.exports=i}),svp.define("player.loadCacheData",function(a,b,c){"use strict";var d=a("base.vars"),e=a("base.cookie"),f=a("base.util"),g=a("base.support"),h=a("base.special"),i=a("base.action"),j=svp.$,k={isMediaAdContent:!1,vid:"",elemId:"",poster:"",posterType:"",mediaType:"",modeType:"",modeTypeList:[],srcType:"",width:"",height:"",volume:0,curPlayUrl:"",srcList:{},pointList:[],autoplay:!1,defControls:!1,loop:!1,preload:!1,title:"",duration:0,curIndex:-1,totCounts:-1,history:{},ipLimit:"",liveEnName:"",liveIcon:"",liveId:"",timeLimit:-1,liveUrl:"",vidList:[],vidCurIndex:-1,isPauseAd:!1,pauseAdImg:"",mediaAdPlatform:"none",copyrightRst:{rst:!0,msg:""},appid:"",debug:!1,mainActor:"",latestCount:"",desc:"",oriUrls:null,channeled:"",fullscreenType:0,isRemHistory:!1,modeList:["nor","hig","sup","app"]},l=function(a,b){j.extend(!0,this,k),j.merge(this,a),j.isUndefined(b)||(this.isMediaAdContent||n(b),"live"===a.mediaType?this._initHLS(b):this._initVOD(b))},m=function(a,b){var c=a.cateCode||a.cate_code||"",d=["vid="+a.vid,"&uid="+e.get("SUV")||"","&plat=17","&pt="+f.getUserPt(),"&prod=h5","&pg=1","&eye=0","&cv=1.0.0","&qd="+(j.isUndefined(i.channelNum)||"0"===i.channelNum?"680":i.channelNum),"&src="+(j.isUndefined(i.channelSrc)||"0"===i.channelSrc?"1105":i.channelSrc),"&cateCode="+c.split(";")[0]||""].join("");return j.isUndefined(b)||(b+=(b.match(/\?/)?"&":"?")+d),b},n=function(a){var b=a.urls;for(var c in b)if("downloadUrl"===c){if(!j.isUndefined(b[c][0])&&""!==b[c][0]){var d=b[c][0];b[c][0]=m(a,d)}}else for(var e in b[c])j.each(b[c][e],function(d,f){b[c][e][d]=m(a,f)})};l.prototype._initHLS=function(a){var b=this;j.merge(this,a),b.title=a.liveName||"",b.srcType=/Android 2\./i.test(d.UA)?"client":g.isSupportM3u8()?"m3u8":"client",b.liveId=a.liveId,b.curPlayUrl=a.liveUrl},l.prototype.getPlayList=function(){return this.srcList[this.modeType]||[]},l.prototype.getNextUrl=function(){var a=this.getPlayList(),b=this.curIndex+1,c=a[b];return j.isUndefined(c)?"":c.url},l.prototype.getFirstUrl=function(){var a=this.getPlayList(),b=a[0];return j.isUndefined(b)?"":b.url},l.prototype._initVOD=function(a){var b=this;b.poster="horizon"===b.posterType?a.horHighPic||a.verHighPic||"":a.verHighPic||a.horHighPic||"";var c=a.totalDuration||a.total_duration||0;b.duration=parseInt(c,10),b.timeLimit>-1&&b.timeLimit<b.duration&&!b.isMediaAdContent&&(b.duration=b.timeLimit),b.title=a.tvname||a.videoName||a.video_name||"",b.mainActor=a.main_actor||"",b.latestCount=a.latest_video_count||"",b.desc=a.video_desc||"",j.isUndefined(a.srcType)?-1===b.timeLimit&&d.IsAndroid||!d.IsAndroid?h.isForceUseM3u8()?b.srcType="m3u8":h.isForceUseDownloadUrl()?(a.urls.mp4={},a.urls.mp4.nor=a.urls.downloadUrl):b.srcType=g.isSupportM3u8()?"m3u8":"mp4":b.srcType="mp4":b.srcType=a.srcType,j.isUndefined(a.urls)||(b.oriUrls=a.urls),!j.isUndefined(a.ep)&&a.ep instanceof Array&&j.each(a.ep,function(a,c){var d={};d.time=parseInt(c.k,10),d.desc=c.v,b.pointList.push(d)}),b.vid=a.vid,""!==b.channeled?a.channeled=b.channeled:b.channeled=a.channeled||"";var e=!1;if(!j.isUndefined(a.urls)){var f=a.urls[b.srcType],i=a.durations;for(var k in f)b.srcList[k]=[],f[k]instanceof Array&&j.each(f[k],function(c,d){var e={};e.url=d,e.duration="m3u8"===b.srcType?a.totalDuration||a.total_duration||-1:parseInt(i[k][c]||-1,10),b.srcList[k].push(e)}),!e&&b.srcList[k].length>0&&(e=!0,b.totCounts=b.srcList[k].length);var l=function(){var c={};c.url="",j.isUndefined(a.urls.downloadUrl)||(c.url=a.urls.downloadUrl[0]||""),c.duration=parseInt(b.duration||-1,10),b.srcType="mp4",b.modeType="nor",b.srcList.nor=[c],b.totCounts=b.srcList.nor.length};e||"client"===b.srcType||l(),b.totCounts>0&&(b.curIndex=0),b.isMediaAdContent||d.IsIphone||!d.IsUCBrowser||"client"===b.srcType||l(),/Android 2./i.test(d.UA)&&l(),b._initCurPlayUrlAndModeType()}},l.prototype._initCurPlayUrlAndModeType=function(){var a=this,b=a.getPlayList(),c=this.modeList;j.each(c,function(c,d){if(!j.isUndefined(a.srcList[d])&&a.srcList[d].length>0){if(0===b.length)return a.modeType=d,!1;a.modeTypeList.push(d)}}),j(c).indexOf("app")>-1&&this.modeTypeList.push("app"),b=this.getPlayList(),b.length>0&&(this.curPlayUrl=b[0].url)},c.exports=l}),svp.define("player.mediaPlayer",function(a,b,c){"use strict";var d=svp.$,e=a("base.console"),f=a("base.vars"),g=function(a){this.videoTag=null,this.$video=null,this.cache=null,this.videoData=null,this.config=null,this.videoList=null,this.currentTime=0,this.duration=0,this._loadedDomFlag=!1,this._timeoutFlag=!1,this._getDataFlag=!1,this._playCheckFlag=!1,this._playCheckTime=6e3,this._init(a)};g.prototype.eventProcess={pause:[],ended:[],userEnded:[],error:[],play:[],playing:[],timeupdate:[]},g.prototype.eventList=["advended","loadedvideodata","loadstart","progress","suspend","abort","error","stalled","play","playing","pause","loadedmetadata","loadeddata","waiting","canplay","canplaythrough","seeking","seeked","timeupdate","ended","ratechange","durationchange","volumechange"],g.prototype.getSrc=function(){return this.$video.attr("src")},g.prototype.setSrc=function(a){this.$video.attr("src",a)},g.prototype.getVolume=function(){return this.videoTag.volume},g.prototype.setVolume=function(a){d.isNumber(a)&&(a=0>a?0:a,a=a>1?1:a,e.log("音量:",a),this.videoTag.volume=a)},g.prototype.getPoster=function(){return this.cache.poster||""},g.prototype.setPoster=function(a){this.changePoster(a)},g.prototype.getPreLoad=function(){return this.$video.attr("preload")},g.prototype.setPreLoad=function(a){this.$video.attr("preload",a)},g.prototype._init=function(){},g.prototype._addEvent=function(){},g.prototype._removeEvent=function(){},g.prototype._fireEvent=function(){},g.prototype._pause=function(){var a=this;this._onDomLoaded(function(){null===a.$video.attr("data-noSupport")&&a.videoTag.pause()})},g.prototype._play=function(){var a=this,b=function(){if(null===a.$video.attr("data-noSupport"))try{if(!this._playCheckFlag&&this.config.autoplay){this._playCheckFlag=!0;var b=0,c=200,d=setInterval(function(){b+=c;var e=b>=a._playCheckTime;(e||a.currentTime>1)&&(e&&(a.pause(),a.$video.trigger("pause")),clearInterval(d))},c)}null!==a.$video.attr("preload")&&a.$video.removeAttr("preload"),a.videoTag.play()}catch(e){a.$video.one("canplay",function(){a.videoTag.paused&&a.videoTag.play()})}};this._onDomLoaded(b)},g.prototype._playOrPause=function(){},g.prototype.pause=function(){var a=this;this._onDomLoaded(function(){a._playOrPause("pause")})},g.prototype.play=function(){var a=this;this._onDomLoaded(function(){a._playOrPause("play")})},g.prototype.seekTo=function(a){var b=this,c=function(a){try{b.videoTag.currentTime=a,b.videoTag.paused&&b.videoTag.play()}catch(c){b.$video.one("canplay",function(){b.videoTag.currentTime=a,b.videoTag.paused&&b.videoTag.play()})}},e=this.androidAdv;if(!d.isUndefined(e)&&!e.isMediaPlayed&&f.IsUCBrowser&&f.IsVivoPhone)return void c(a);var g=this.cache.srcList[this.cache.modeType];if(/Android\s4\./i.test(f.UA)&&!f.IsBaiduBrowser&&this._showLoading(),1===g.length)c(a);else{var h=0;d.each(g,function(d,e){if(h+e.duration>a){var f=b.cache;if(d!==f.curIndex){f.curIndex=d;var g=e.url;f.curPlayUrl=g,b.setSrc(g)}return a-=h,setTimeout(function(){c(a)},300),!1}h+=e.duration})}},g.prototype.on=function(){},g.prototype.off=function(){},g.prototype.trigger=function(){},g.prototype.one=function(){},g.prototype.htmlTo=function(){},g.prototype.playByMode=function(){},g.prototype.updateMedia=function(){},g.prototype.changePoster=function(){},g.prototype._onDomLoaded=function(a){var b=this;if(this._loadedDomFlag)a.call(this);else var c=setInterval(function(){b._loadedDomFlag&&(clearInterval(c),a.call(b))},100)},c.exports=g}),svp.define("player.message",function(a){"use strict";var b=svp.$,c=a("base.vars"),d=a("player.mediaPlayer"),e=function(a){var b="";return a.background&&(b+="background:"+a.background+";"),a.color&&(b+="color:"+a.color+";"),a.fontSize&&(b+="font-size:"+a.fontSize+";"),b},f=function(a,b,c){return'<a href="'+(a.link?a.link:"javascript:void(0);")+'" class="msg_btn_'+c+" msg_btn "+(a.ClassName?a.ClassName:"")+'" style="'+b+'">'+a.text+"</a>"};d.prototype._hideMsg=function(){this.$main&&0!==this.$main.length||this._initDoms(),this.$main.children(".message").hide(),this.$main.find(".player_main").length&&this.$main.find(".player_main").show()},d.prototype._showMsg=function(a){this.$main&&0!==this.$main.length||this._initDoms(),this._pause(),this._hideLoading(),this.$main.find(".player_main").length&&this.$main.find(".player_main").hide();var d,g,h,i,j,k;d=h=j=k="",d=e(a),g=a.dom?a.dom:'<div class="msg_cont"><span class="msg">'+a.text+"</span></div>",a.btns&&(a.btns.btnA&&(j=e(a.btns.btnA),h+=f(a.btns.btnA,j,"a")),a.btns.btnB&&(k=e(a.btns.btnB),h+=f(a.btns.btnB,k,"b")),""!==h&&(h='<div class="msg_btns">'+h+"</div>")),i='<div class="message '+(a.className?a.className:"")+'" style="'+d+'"><div class="inner_msg">'+g+h+"</div></div>",this.$main.children(".message").length?this.$main.find(".message").empty().append('<div class="inner_msg">'+g+h+"</div>").attr("style",d).show():this.$main.append(i),a.btns&&(a.btns.btnA&&a.btns.btnA.callback&&b.isFunction(a.btns.btnA.callback)&&this.$main.find(".message .msg_btn_a").on(c.END_EVENT,function(){a.btns.btnA.callback.call(this)}),a.btns.btnB&&a.btns.btnB.callback&&b.isFunction(a.btns.btnB.callback)&&this.$main.find(".message .msg_btn_b").on(c.END_EVENT,function(){a.btns.btnB.callback.call(this)})),a.callback&&b.isFunction(a.callback)&&a.callback.call(this.$main.find(".message")[0])}}),svp.define("player.adv",function(a){"use strict";var b=svp.$,c=a("player.mediaPlayer"),d=a("base.vars"),e=a("base.special"),f=a("adv.android"),g=a("adv.ios");c.prototype._initAdvFlag=!1,c.prototype._adUpdateFlag=!1,c.prototype.adInit=function(){var a=this.config;"live"!==a.mediaType&&("play_source"!==a.dataType&&e.isAllowPlayAdv()&&((d.IsIphone||d.IsIpad)&&a.mediaAdPlatform.indexOf("ios")>-1?this.adv=new g(this,a):d.IsAndroid&&a.mediaAdPlatform.indexOf("android")>-1&&(this.adv=new f(this,a))),b.isUndefined(this.adv)||this.adv.addAdvertise(),b.isUndefined(this.adv)&&this.$video.attr("data-adover","true"),(this.cache.autoplay||d.IsIphone||d.IsOldWindowsPhone||d.IsUCBrowser||d.IsQQBrowser||d.IsMIOne)&&(this._ctrlShowFlag=!0))}}),svp.define("player.playHistory",function(a,b,c){"use strict";var d=a("base.store"),e={param:{localHistoryName:"sohu_video_history",maxSize:20,checkArr:["sid","vid","site","playTime","duration"],paramArr:["sid","vid","site","cid","playTime","duration","sysTime","title"]},model:{localDataStr:""},view:{},ctrl:{}},f=e.param,g=e.model,h=(e.view,e.ctrl);g.historyCheck=function(a){var b=!0;return $.each(f.checkArr,function(c,d){return"undefiend"==typeof a[d]?(b=!1,!1):void 0}),b},g.objToStr=function(a){var b=[],c=!1;try{var d=parseInt(a.duration,10),e=parseInt(a.playTime,10);e/d>.97&&(c=!0)}catch(g){}return c?"finished":(a.sysTime=Date.now(),$.each(f.paramArr,function(c,d){if("playTime"===d)try{a[d]=parseInt(a[d],10)}catch(e){}a[d]=a[d]?a[d]:"",b.push(encodeURIComponent(a[d]))}),b.join(","))},g.strToObj=function(a){var b=null;if("string"==typeof a&&"null"!==a&&""!==a){var c=a.split(",");b={},$.each(f.paramArr,function(a,d){b[d]="playTime"===d||"duration"===d||"sysTime"===d||"flag"===d||"sid"===d?parseInt(c[a],10):decodeURIComponent(c[a])})}return b},g.strToArr=function(a){var b=[];if("string"==typeof a&&""!==a&&"null"!==a){0===a.indexOf("|")&&(a=a.substr(1));var c=a.split("|");$.each(c,function(a,c){b.push(g.strToObj(c))})}return b},h.setHistory=function(a){if(g.historyCheck(a)){var b=g.objToStr(a);""===g.localDataStr&&(g.localDataStr=d.get(f.localHistoryName)||"");var c=""!==g.localDataStr?g.localDataStr.split("|"):[],e=","+a.vid+","+a.site+",";if("finished"!==b&&-1===g.localDataStr.indexOf(e))c.unshift(b);else{var h=[];"finished"!==b&&h.push(b),$.each(c,function(a,b){-1===b.indexOf(e)&&h.push(b)}),c=h}c.length>f.maxSize&&(c.length=f.maxSize),g.localDataStr=c.join("|"),d.set(f.localHistoryName,g.localDataStr)}},h.getHistory=function(a){var b=[],c=g.localDataStr&&""!==g.localDataStr?g.localDataStr:d.get(f.localHistoryName);if(c&&"undefined"!=typeof a){if("undefined"!=typeof a.vid&&"undefined"!=typeof a.site){var e=new RegExp("(^|\\|)\\d+,"+a.vid+","+a.site+"(,[\\w\\.\\W]*){6}","ig"),h=c.match(e)+"";b=g.strToObj(h),b=null===b?[]:[b]}else if("undefined"!=typeof a.sid){var i=g.strToArr(c);$.each(i,function(c,d){d.sid+""==a.sid+""&&b.push(d)}),("undefiend"==typeof a.type||0===a.type||1!==a.type)&&(b.length=1)}}else b=g.strToArr(c);return b},window.SohutvJSBridge=window.SohutvJSBridge||{},window.SohutvJSBridge.setHistory=h.setHistory,window.SohutvJSBridge.getHistory=h.getHistory,c.exports={setHistory:h.setHistory,getHistory:h.getHistory}}),svp.define("player.poster",function(a){"use strict";var b=a("player.mediaPlayer");b.prototype.hidePoster=function(){this.$posterCon.length>0&&this.$posterCon.addClass("hidden")},b.prototype.showPoster=function(){this.$posterCon.length>0&&this.$posterCon.removeClass("hidden")},b.prototype.changePoster=function(a){a&&a.url&&this.$posterCon.length>0&&this.$posterCon.css({"background-image":"url("+a.url+");"})}}),svp.define("player.settings",function(a,b,c){"use strict";var d=svp.$,e=a("base.special"),f={};f.PLAY_MODE={nor:"流畅",hig:"高清",sup:"超清",ori:"原画",app:"超清app"};var g={data:null,mainId:"",playerId:"",width:"100%",height:"100%",pWidth:"",pHeight:"",volume:1,elemId:"videoTagId_"+Date.now(),dataType:"",autoplay:!0,defControls:!1,loop:!1,preload:!1,mediaType:"vod",modeType:"nor",posterType:"horizon",timeLimit:-1,isPauseAd:!1,pauseAdImg:"",mediaAdPlatform:"none",isCopyrightCheck:!0,adClose:"0",appid:"tv",debug:!1,channeled:"",fullscreenType:0,isRemHistory:!1,modeList:["nor","hig","sup","ori","app"],isShowRecommend:!1};f.initConfig=function(a){var b=d.extend(!0,{},g,a);return null!==b.data&&(b.data=d.extend(!0,{},b.data)),""===b.mainId&&(d.isUndefined(svp.mainId)&&(svp.mainId=1),b.mainId="svp_main_"+svp.mainId,svp.mainId++),e.isForbidAutoplay()&&(b.autoplay=!1),b},c.exports=f}),svp.define("player.showRecommend",function(a){"use strict";var b=svp.$,c=a("base.vars"),d=a("base.console"),e=a("player.mediaPlayer"),f=a("data.recommend"),g=a("base.slide"),h=function(a){var b=[],c=[];b.push('<div class="svp_recommend_wrap player_recommend_wrap">'),b.push('<div class="about_recommend">'),b.push('<div class="title">相关推荐</div>'),b.push('<div class="right_btn">'),b.push('<span class="svp_replay replay btns">重新播放</span>'),b.push('<a  class="player_recommend_more btns" href="http://m.tv.sohu.com">更多</a>'),b.push("</div></div>"),b.push('<div class="recommend_videos_wrap">'),b.push('<div class="svp_recommend_videos recommend_videos">'),c.push('<ul class="svp_page_point page_point">');for(var d=0;d<a.length;d++){d%2===0&&(c.push("<li>"),b.push('<ul class="svp_video_list video_list">')),b.push('<li class="svp_item recommend_videos_item">');var e=a[d].url_html5||"http://m.tv.sohu.com/v"+(a[d].vid||0)+".shtml";b.push('<a href="'+(a[d].url_html5||e)+'" data-href="'+(a[d].url_html5||"")+'" class="svp_link item_link">'),b.push('<b style="background-image: url('+(a[d].hor_big_pic||"")+');background-size:cover;"></b>'),b.push('<div class="playend_recommend_vtilte">'+(a[d].album_name||"")+"</div>"),b.push("</a></li>"),d%2===1&&b.push("</ul>")}return c.push("</ul>"),b.push("</div>"),b.push("</div>"),b.push(c.join("")),b.push("</div>"),b.push("</div>"),b.join("")};e.prototype.showRecommend=function(){var a=this;return d.log("showRecommend"),d.log("_this.lastVid"+a.lastVid),d.log("_this.videoData.vid"+a.videoData.vid),b(".svp_recommend_wrap").length>0&&a.lastVid===a.videoData.vid?void a.$main.addClass("recommend_show"):void f.getData("recommend",a.videoData,function(d){if(null!==d&&""!==d&&d.videos&&d.videos.length>0){d=d.videos,b(".svp_recommend_wrap").remove();var e=h(d);a.$main.append(e).addClass("recommend_show"),a.lastVid=a.videoData.vid,a.$rePlay=a.$main.find(".svp_replay"),a.$rePlay.click(function(){a._sendVVFlag=!1,a._sendRealVVFlag=!1,a._sendStartFlag=!1,a._sendEndFlag=!1,a._playByHistoryFlag=!1,a._timeoutFlag=!1,c.IsIphone&&/^[0-7]\./i.test(c.OsVersion)?a.seekTo(0):a.updateMedia(a.videoData,!0),a.$main.removeClass("recommend_show"),a._showRecommendFlag=!0}),g.Scroll({scrollClass:"svp_recommend_videos",moveSpeed:200,loop:!0,auto:!1})}})},e.prototype.hideRecommend=function(){this.$main.removeClass("recommend_show")}}),svp.define("player.update",function(a){"use strict";var b=svp.$,c=a("player.mediaPlayer"),d=a("base.vars"),e=a("trace.video"),f=a("player.dataService"),g=a("player.loadCacheData"),h=a("base.special"),i=a("player.html5UI"),j=a("player.liveUI"),k=a("player.errorTypes"),l=a("data.appDownload"),m=a("base.console"),n=a("player.settings"),o=a("base.action"),p=a("trace.click"),q=function(a){var c="error";if(!b.isUndefined(a)&&null!==a)if(b.isUndefined(a.urls)||b.isUndefined(a.durations))b.isUndefined(a.vid)&&b.isUndefined(a.liveId)?b.isUndefined(a.src)||(c="source"):c="partial";else try{var e=d.IsIphone||d.IsQQBrowser||h.isForceUseM3u8()?"m3u8":"mp4";c="whole";for(var f in a.urls[e])a.durations[f].length!==a.urls[e][f].length&&(c="partial")}catch(g){c="partial"}return c},r=function(a){var c=a.cache;!b.isUndefined(a.adv)&&b.isFunction(a.adv.hideMediaView)&&a.adv.hideMediaView(),a.$title.html(c.title),document.title=c.title,a.$ctrlCurTime.html(b.formatSeconds(0)),a.$ctrlDuration.html(b.formatSeconds(c.duration)),a.$ctrlCurPlayedBar.css({width:0}),a.changePoster({url:c.poster})},s=function(a,c){if(a.trigger("loadedvideodata"),"videoDataList"===a.videoList.type){var f=a.videoList.videoDataList[a.videoList.curIndex];c.channeled=f.channeled||"1212120001",c.timeLimit=f.timeLimit||"0"}window.videoData=c,l.getChannelInfo(null,function(f){if(a.config.timeLimit<=0&&!d.IsWeixinBrowser&&(c.timeLimit>0&&(a.config.timeLimit=c.timeLimit),!b.isUndefined(c.cid)&&!b.isUndefined(f.cid)))try{var h=c.cid,n=b(f.cid.split(","));n.indexOf(h+"")>-1&&f.timeLimit>0&&(a.config.timeLimit=f.timeLimit)}catch(q){}if(a._firstLoadFlag&&"0"===f.startapp&&!d.IsWeixinBrowser&&(a.config.autoplay=!1),!b.isUndefined(f.quality)){var s=(f.quality+"").split(",");s.length>0&&(a.config.modeList=s)}if(b.isUndefined(f.isClosed)||(a.config.adClose=f.isClosed+""),a.cache=new g(a.config,c),a.videoData=b.extend(!0,{},c),a._firstLoadFlag){if(a._adUpdateFlag=!1,a.$player.append("live"===a.config.mediaType?j.makeVideoTmpl(a.cache):i.makeVideoTmpl(a.cache)),m.log("加载dom完成, 耗时--->"+(Date.now()-svp.debug.playerLoadDomStartTime)/1e3),a._initDoms(),"noSupport"===a.$video.attr("data-nosupport")){var t="live"===a.config.mediaType?k.SUPPORT[305]:k.SUPPORT[300];return void a._showMsg({text:t,btns:{btnA:{text:"下载搜狐视频客户端",callback:function(){l.gotoDownload()}}}})}a._loadedDomFlag=!0,a._initEvent(),a._initControls(),a._initException(),a._autoNextVideoService(),a.$loadingDesc.oriHide(),a.$video.length>0&&(a.videoTag.volume=a.config.volume,a.$ctrlDuration.html(b.formatSeconds(a.cache.duration)))}else b("body").trigger("player:updateMedia"),r(a),a._adUpdateFlag=!0;a.setSrc(a.cache.curPlayUrl),a.duration=a.cache.duration,a.currentTime=0,a._hideLoading(),a.cache.autoplay?(a.$midPlay.oriHide(),a._sendVVFlag||(m.log("统计: vv"),e.vv(),a._sendVVFlag=!0),a._playOrPause("play")):(a._playOrPause("pause"),a._hideMainCtrl(),a._showMidPlayBtn(),a.showPoster(),(d.IsUCBrowser||d.IsQQBrowser&&!/QQBrowser\/4\.2/i.test(d.UA))&&a.$video.oriHide()),a._firstLoadFlag&&(b.isUndefined(o.URLGlobalParams.player)||(a._fullOrShrink("fullScreen"),a._playOrPause("play"))),m.log("播放器加载时间:"+(Date.now()-svp.debug.playerLoadStartTime)/1e3+"秒"),a._sendPlayDisplayCompleteFlag||(m.log("发送行为统计点:(play_display_complete)"),p.pingback(null,"play_display_complete"),a._sendPlayDisplayCompleteFlag=!0)})};c.prototype.updateMedia=function(a,c){var g=this;if(!b.isUndefined(a)){var h=q(a);if("error"!==h){if(null!==g.videoData&&(g.hideRecommend(),g.config.isShowRecommend&&"source"===h&&g.videoData.video_src.indexOf(a.src)>-1))return void(g._showRecommendFlag=!0);g._showRecommendFlag=!1,g._firstLoadFlag||(svp.debug.playerLoadStartTime=Date.now(),this._sendRealVVFlag&&!this._sendEndFlag&&(m.log("统计: ended"),e.ended(this.currentTime,this._bufferCount),this._sendEndFlag=!0),b.isUndefined(this.videoData)||(this.config.data=this.videoData,this.config.dataType="video_data",this.config.isMediaAdContent=!1,a.channeled&&"default"!==a.channeled&&(this.config.channeled=a.channeled)),this._sendVVFlag=!1,this._sendRealVVFlag=!1,this._sendStartFlag=!1,this._sendEndFlag=!1,this._playByHistoryFlag=!1,this._timeoutFlag=!1,b.isUndefined(this.config)&&(this.config=n.initConfig({})),a=b.extend(!0,{},a),"undefined"!=typeof c&&(this.config.autoplay=c),this._playOrPause("pause"),d.IsBaiduBrowser||this._showLoading()),"partial"===h||"source"===h?(this._getDataFlag=!1,setTimeout(function(){g._getDataFlag||(g._timeoutFlag=!0,g._showMsg({text:k.REQUEST[400],btns:{btnA:{text:"刷新",callback:function(){g._timeoutFlag=!1,g._hideMsg(),g.updateMedia(a,c)}}}}))},this._dataTimeout),svp.debug.playerLoadMediaDataStartTime=Date.now(),f.auto(a,function(d){m.log("视频数据获取完成, 耗时--->"+(Date.now()-svp.debug.playerLoadMediaDataStartTime)/1e3),g._timeoutFlag||(g._getDataFlag=!0,"200"!==d.code||b.isUndefined(d.data)?g._showMsg(""===d.code||b.isUndefined(d.data)?{text:k.PROCESS[201],btns:{btnA:{text:"刷新",callback:function(){g.updateMedia(a,c)}}}}:{text:d.msg}):s(g,d.data))})):s(g,a)}else g._showMsg({text:k.PROCESS[202]})}}}),svp.define("player.videoList",function(a){"use strict";var b=svp.$,c=a("player.mediaPlayer"),d=a("player.errorTypes");c.prototype._videoList=function(a){if(b.isUndefined(a))return this._showMsg({text:d.PROCESS[202]}),!1;var c={};return!b.isUndefined(a.vidList)&&b.isArray(a.vidList)?(c.vidList=a.vidList,c.site=a.site||"1",c.curIndex=0,c.type="vidList"):!b.isUndefined(a.videoDataList)&&b.isArray(a.videoDataList)&&(c.videoDataList=a.videoDataList,c.curIndex=0,c.type="videoDataList"),c}});